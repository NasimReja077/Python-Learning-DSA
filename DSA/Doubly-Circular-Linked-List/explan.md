# Complete Line-by-Line Explanation: Insert at Beginning (Doubly Circular Linked List)

I'll provide an extremely detailed explanation with comprehensive diagrams.

---

## Complete Code with Line Numbers

```python
def insert_beginning(self, value):          # Line 1
    new_node = Node(value)                  # Line 2
                                            # Line 3 (blank)
    if self.head is None:                   # Line 4
        # Empty list - node points to itself  # Line 5 (comment)
        self.head = new_node                # Line 6
        new_node.next = new_node            # Line 7
        new_node.prev = new_node            # Line 8
        print(value, "inserted as first node")  # Line 9
        return                              # Line 10
                                            # Line 11 (blank)
    # Find last node                        # Line 12 (comment)
    last = self.head.prev                   # Line 13
                                            # Line 14 (blank)
    # Connect new node                      # Line 15 (comment)
    new_node.next = self.head               # Line 16
    new_node.prev = last                    # Line 17
                                            # Line 18 (blank)
    # Update head and last connections      # Line 19 (comment)
    self.head.prev = new_node               # Line 20
    last.next = new_node                    # Line 21
                                            # Line 22 (blank)
    # Update head pointer                   # Line 23 (comment)
    self.head = new_node                    # Line 24
    print(value, "inserted at beginning")   # Line 25
```

---

# SCENARIO 1: INSERT INTO EMPTY LIST

Let's insert **10** into an empty doubly circular linked list.

---

## Initial State: Empty List

```
self.head = None

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DOUBLY CIRCULAR LINKED LIST        â”‚
â”‚  Status: EMPTY                      â”‚
â”‚                                     â”‚
â”‚  No nodes exist                     â”‚
â”‚  self.head points to None           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 1: Function Definition

```python
def insert_beginning(self, value):
```

**Function Call:**
```
insert_beginning(10)
                 â”‚
                 â””â”€â”€â”€ value = 10
```

**Visual:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FUNCTION CALLED             â”‚
â”‚  insert_beginning(10)        â”‚
â”‚                              â”‚
â”‚  Parameters:                 â”‚
â”‚  â€¢ self: DoublyCircular...   â”‚
â”‚  â€¢ value: 10                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 2: Create New Node

```python
new_node = Node(value)
```

**What it does:**
- Creates a new `Node` object with data = 10
- The Node constructor sets:
  - `new_node.data = 10`
  - `new_node.prev = None`
  - `new_node.next = None`

**Diagram AFTER Line 2:**

```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     NODE      â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ prev:  NULL   â”‚
              â”‚ data:   10    â”‚
              â”‚ next:  NULL   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


       self.head = None
       (List is still empty)
```

**Detailed Memory View:**
```
Memory Address: 0x1A2B3C

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NEW NODE CREATED                â”‚
â”‚  Address: 0x1A2B3C               â”‚
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ prev   â”‚  NULL  â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚ data   â”‚   10   â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚ next   â”‚  NULL  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                  â”‚
â”‚  Variable: new_node â†’ 0x1A2B3C  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 4: Check if List is Empty

```python
if self.head is None:
```

**What it does:**
- Checks if the list has any nodes
- `self.head is None` â†’ list is empty

**In Our Case:**
```
self.head = None

Evaluation:
self.head is None â†’ None is None â†’ TRUE âœ“

Action: Execute lines 6-10
```

**Visual Decision:**
```
                LINE 4
                  â”‚
                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Is list empty?  â”‚
        â”‚ self.head?      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
          â”‚               â”‚
         YES             NO
          â”‚               â”‚
          â–¼               â–¼
    Lines 6-10       Lines 13-25
    (Empty List)     (Non-Empty)
          â”‚
    [We execute this]
```

---

## LINE 6: Set HEAD to New Node

```python
self.head = new_node
```

**What it does:**
- Makes `self.head` point to the new node
- The new node becomes the head of the list

**Diagram AFTER Line 6:**

```
    new_node â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ (both point to same object)
    self.head â”€â”€â”€â”€â”€â”€â”€â”¤
                     â–¼
                 0x1A2B3C
                     â”‚
                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     NODE      â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ prev:  NULL   â”‚ â† Still NULL (need to fix)
              â”‚ data:   10    â”‚
              â”‚ next:  NULL   â”‚ â† Still NULL (need to fix)
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 6                â”‚
â”‚                              â”‚
â”‚  self.head â†’ 0x1A2B3C        â”‚
â”‚  new_node  â†’ 0x1A2B3C        â”‚
â”‚                              â”‚
â”‚  Both reference same node    â”‚
â”‚  But node is NOT circular    â”‚
â”‚  yet (prev & next are NULL)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 7: Make Next Circular (Point to Itself)

```python
new_node.next = new_node
```

**What it does:**
- Sets the node's `next` pointer to point to **itself**
- Creates forward circular link

**Visual Explanation:**

**BEFORE Line 7:**
```
       self.head
       new_node
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚NULLâ”‚ 10 â”‚NULLâ”‚  â† next is NULL
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
```

**Executing Line 7:**
```
new_node.next = new_node

Step 1: Evaluate right side
    new_node â†’ 0x1A2B3C (the node itself)

Step 2: Assign to left side
    new_node.next â† 0x1A2B3C

Result: Node's next points to itself
```

**AFTER Line 7:**
```
       self.head
       new_node
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚NULLâ”‚ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                      â”‚
         â–²            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         (next points to itself)
```

**Detailed View:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 7                    â”‚
â”‚                                  â”‚
â”‚  NODE at 0x1A2B3C:               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ prev   â”‚  NULL  â”‚ â† Still NULLâ”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚ data   â”‚   10   â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚ next   â”‚0x1A2B3Câ”‚ â”€â”€â”€â”        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚        â”‚
â”‚       â–²                 â”‚        â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                  â”‚
â”‚  Forward circular link created!  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 8: Make Prev Circular (Point to Itself)

```python
new_node.prev = new_node
```

**What it does:**
- Sets the node's `prev` pointer to point to **itself**
- Creates backward circular link
- Completes the doubly circular structure

**Visual Explanation:**

**BEFORE Line 8:**
```
       self.head
       new_node
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚NULLâ”‚ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â–²            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         prev is still NULL
```

**Executing Line 8:**
```
new_node.prev = new_node

Step 1: Evaluate right side
    new_node â†’ 0x1A2B3C (the node itself)

Step 2: Assign to left side
    new_node.prev â† 0x1A2B3C

Result: Node's prev points to itself
```

**AFTER Line 8:**
```
       self.head
       new_node
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â–²  â”‚            â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚  (next points to itself)
      â”‚
      â””â”€â”€â”€â”€â”€ (prev points to itself)
```

**Complete Circular Structure:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DOUBLY CIRCULAR STRUCTURE CREATED!  â”‚
â”‚                                      â”‚
â”‚       self.head                      â”‚
â”‚           â”‚                          â”‚
â”‚           â–¼                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                  â”‚
â”‚  â”Œâ†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”               â”‚
â”‚  â”‚ â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚               â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚               â”‚
â”‚  â”‚      â–²            â”‚               â”‚
â”‚  â”‚      â”‚            â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜            â”‚               â”‚
â”‚   (prev)             â”‚               â”‚
â”‚                      â”‚               â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                            â”‚
â”‚         â””â”€â†’ (next)                   â”‚
â”‚                                      â”‚
â”‚  Both prev and next point to itself! â”‚
â”‚                                      â”‚
â”‚  Forward:  10 â†’ 10 â†’ 10 â†’ ...        â”‚
â”‚  Backward: 10 â† 10 â† 10 â† ...        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 8                â”‚
â”‚                              â”‚
â”‚  NODE at 0x1A2B3C:           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x1A2B3Câ”‚ â”€â”€â”€â”    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚    â”‚
â”‚  â”‚ data   â”‚   10   â”‚    â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚    â”‚
â”‚  â”‚ next   â”‚0x1A2B3Câ”‚ â”€â”€â”€â”¼â”€â”€â” â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚ â”‚
â”‚       â–²                 â”‚  â”‚ â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚
â”‚  âœ… Doubly circular!         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 9: Print Confirmation

```python
print(value, "inserted as first node")
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                       â”‚
â”‚                                 â”‚
â”‚  10 inserted as first node      â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 10: Exit Function

```python
return
```

**What it does:**
- Exits the function immediately
- Lines 13-25 will NOT be executed

**Control Flow:**
```
Lines Executed: 1, 2, 4, 6, 7, 8, 9, 10
Lines Skipped: 13, 16, 17, 20, 21, 24, 25
```

---

## Final State After First Insertion

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â–²  â”‚            â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚
                      â–¼
              (Points to itself)

List Structure:
â€¢ Forward:  10 â†’ 10 â†’ 10 â†’ ...
â€¢ Backward: 10 â† 10 â† 10 â† ...
â€¢ Total nodes: 1
```

**Verification:**
```
âœ… self.head points to Node 10
âœ… Node 10.next points to Node 10 (itself)
âœ… Node 10.prev points to Node 10 (itself)
âœ… Doubly circular structure created!
```

---

---

# SCENARIO 2: INSERT INTO NON-EMPTY LIST

Now let's insert **5** at the beginning of the existing list: **10 â‡„ (back to 10)**

---

## Initial State: List with One Node

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â–²  â”‚            â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚
                      â–¼

Current List: 10 â‡„ (back to 10)
Goal: Insert 5 at beginning
Expected: 5 â‡„ 10 â‡„ (back to 5)
```

---

## LINE 1: Function Definition

```python
def insert_beginning(self, value):
```

**Function Call:**
```
insert_beginning(5)
                 â”‚
                 â””â”€â”€â”€ value = 5
```

---

## LINE 2: Create New Node

```python
new_node = Node(value)
```

**Diagram AFTER Line 2:**

```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     NODE      â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ prev:  NULL   â”‚
              â”‚ data:    5    â”‚
              â”‚ next:  NULL   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â” (Existing node)
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â–²  â”‚            â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TWO SEPARATE NODES          â”‚
â”‚                              â”‚
â”‚  NEW NODE (not in list):     â”‚
â”‚  Address: 0x2B3C4D           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚  NULL  â”‚         â”‚
â”‚  â”‚ data   â”‚   5    â”‚         â”‚
â”‚  â”‚ next   â”‚  NULL  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  EXISTING NODE (in list):    â”‚
â”‚  Address: 0x1A2B3C           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x1A2B3Câ”‚ (self)  â”‚
â”‚  â”‚ data   â”‚  10    â”‚         â”‚
â”‚  â”‚ next   â”‚0x1A2B3Câ”‚ (self)  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  self.head â†’ 0x1A2B3C        â”‚
â”‚  new_node  â†’ 0x2B3C4D        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 4: Check if List is Empty

```python
if self.head is None:
```

**In Our Case:**
```
self.head = 0x1A2B3C (points to Node 10)

Evaluation:
self.head is None â†’ 0x1A2B3C is None â†’ FALSE âœ—

Action: Skip lines 6-10
        Jump to line 13
```

**Visual Decision:**
```
                LINE 4
                  â”‚
                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Is list empty?  â”‚
        â”‚ self.head?      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
          â”‚               â”‚
         YES             NO â† We go this way
          â”‚               â”‚
          â–¼               â–¼
    Lines 6-10       Lines 13-25
    (SKIP)           (EXECUTE)
```

---

## LINE 13: Find Last Node

```python
last = self.head.prev
```

**What it does:**
- In a doubly circular list, the **last node** is directly accessible via `self.head.prev`
- This is **O(1)** - instant access!
- No need to traverse the entire list!

**Why This Works:**
```
In doubly circular list:
â€¢ First node's prev â†’ Last node
â€¢ Last node's next â†’ First node

So: self.head.prev gives us the last node directly!
```

**Visual Explanation:**

**BEFORE Line 13:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â–²  â”‚            â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â””â”€â”€â”€ self.head.prev
           (points to itself - the last node)
```

**Executing Line 13:**
```
last = self.head.prev

Step 1: Evaluate right side
    self.head â†’ Node 10
    self.head.prev â†’ Node 10 (points to itself)

Step 2: Assign to left side
    last â† Node 10

Result: last points to Node 10 (the last/only node)
```

**AFTER Line 13:**
```
    self.head
    last          (both point to same node)
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â–²  â”‚            â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 13               â”‚
â”‚                              â”‚
â”‚  new_node  â†’ 0x2B3C4D (5)    â”‚
â”‚  self.head â†’ 0x1A2B3C (10)   â”‚
â”‚  last      â†’ 0x1A2B3C (10)   â”‚
â”‚                              â”‚
â”‚  Found last node in O(1)!    â”‚
â”‚  (Advantage of doubly        â”‚
â”‚   circular structure)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**If list had multiple nodes (e.g., 10 â‡„ 20 â‡„ 30):**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â–²  â”‚            â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â†’ Node 20 â†’ Node 30 â”€â”€â”
      â”‚               â”‚                       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         self.head.prev points directly to last (30)
```

---

## LINE 16: Connect New Node's Next to Current Head

```python
new_node.next = self.head
```

**What it does:**
- Makes new node's `next` pointer point to the current head (Node 10)
- Creates forward link from new node to existing list

**Visual Explanation:**

**BEFORE Line 16:**
```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚NULLâ”‚ 5  â”‚NULLâ”‚  â† next is NULL
              â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜


       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â–²                â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Executing Line 16:**
```
new_node.next = self.head

Step 1: Evaluate right side
    self.head â†’ 0x1A2B3C (Node 10)

Step 2: Assign to left side
    new_node.next â† 0x1A2B3C

Result: New node's next points to Node 10
```

**AFTER Line 16:**
```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚NULLâ”‚ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
                                  â”‚ new_node.next = self.head
       self.head                  â”‚
       last                       â”‚
           â”‚                      â”‚
           â–¼                      â”‚
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”              â”‚
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”           â”‚
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚           â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚           â”‚
      â–²  â”‚            â”‚           â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼
                          [Points to Node 10]
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 16               â”‚
â”‚                              â”‚
â”‚  NODE 5:                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚  NULL  â”‚         â”‚
â”‚  â”‚ data   â”‚   5    â”‚         â”‚
â”‚  â”‚ next   â”‚0x1A2B3Câ”‚ â”€â”€â†’ 10  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  NODE 10:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x1A2B3Câ”‚ (self)  â”‚
â”‚  â”‚ data   â”‚  10    â”‚         â”‚
â”‚  â”‚ next   â”‚0x1A2B3Câ”‚ (self)  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  âœ… Forward link created     â”‚
â”‚  âŒ Still need backward link â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 17: Connect New Node's Prev to Last

```python
new_node.prev = last
```

**What it does:**
- Makes new node's `prev` pointer point to the last node (Node 10)
- Creates backward link from new node to end of list

**Visual Explanation:**

**BEFORE Line 17:**
```
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚NULLâ”‚ 5  â”‚ â—â”€â”€â”¼â”€â”€â†’ Node 10
              â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                â–²
                â””â”€â”€â”€ Still NULL
```

**Executing Line 17:**
```
new_node.prev = last

Step 1: Evaluate right side
    last â†’ 0x1A2B3C (Node 10)

Step 2: Assign to left side
    new_node.prev â† 0x1A2B3C

Result: New node's prev points to Node 10
```

**AFTER Line 17:**
```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
                â–²  â”‚              â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â†’ Node 10
                â”‚                 â”‚
                â”‚                 â”‚
       self.head                  â”‚
       last                       â”‚
           â”‚                      â”‚
           â–¼                      â”‚
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”              â”‚
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”           â”‚
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚           â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚           â”‚
      â–²  â”‚            â”‚           â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼
      
      new_node.prev = last (Node 10)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 17               â”‚
â”‚                              â”‚
â”‚  NODE 5:                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x1A2B3Câ”‚ â”€â”€â†’ 10  â”‚
â”‚  â”‚ data   â”‚   5    â”‚         â”‚
â”‚  â”‚ next   â”‚0x1A2B3Câ”‚ â”€â”€â†’ 10  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚       â–²           â”‚           â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚   Both point to Node 10       â”‚
â”‚                              â”‚
â”‚  NODE 10:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x1A2B3Câ”‚ (self)  â”‚
â”‚  â”‚ data   â”‚  10    â”‚         â”‚
â”‚  â”‚ next   â”‚0x1A2B3Câ”‚ (self)  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  âœ… New node fully connected â”‚
â”‚  âŒ But Node 10 doesn't know â”‚
â”‚     about Node 5 yet!        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 20: Update Head's Prev to New Node

```python
self.head.prev = new_node
```

**What it does:**
- Makes the current head (Node 10) point backward to the new node (Node 5)
- Fixes the backward circular link

**Visual Explanation:**

**BEFORE Line 20:**
```
    self.head (Node 10)
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â–²                â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Points to itself (OLD)
```

**Executing Line 20:**
```
self.head.prev = new_node

Step 1: Evaluate right side
    new_node â†’ 0x2B3C4D (Node 5)

Step 2: Assign to left side
    self.head.prev â† 0x2B3C4D

Result: Node 10's prev now points to Node 5
```

**AFTER Line 20:**
```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
                â–²  â”‚              â”‚
                â”‚  â”‚              â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ Node 10
                â”‚                 â”‚
       self.head                  â”‚
           â”‚                      â”‚
           â–¼                      â”‚
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”              â”‚
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”           â”‚
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚           â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚           â”‚
      â–²  â”‚            â”‚           â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
      â”‚                           â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      
      self.head.prev = new_node
      (Node 10 now points back to Node 5)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 20               â”‚
â”‚                              â”‚
â”‚  NODE 5:                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x1A2B3Câ”‚ â”€â”€â†’ 10  â”‚
â”‚  â”‚ data   â”‚   5    â”‚         â”‚
â”‚  â”‚ next   â”‚0x1A2B3Câ”‚ â”€â”€â†’ 10  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚       â–²                      â”‚
â”‚       â”‚                      â”‚
â”‚  NODE 10:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x2B3C4Dâ”‚ â”€â”€â†’ 5   â”‚
â”‚  â”‚ data   â”‚  10    â”‚         â”‚
â”‚  â”‚ next   â”‚0x1A2B3Câ”‚ (self)  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚       â”‚           â”‚           â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚   Still points to itself      â”‚
â”‚                              â”‚
â”‚  âœ… Backward link fixed      â”‚
â”‚  âŒ Forward link from 10     â”‚
â”‚     still needs update       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 21: Update Last's Next to New Node

```python
last.next = new_node
```

**What it does:**
- Makes the last node (Node 10) point forward to the new node (Node 5)
- Completes the forward circular link

**Visual Explanation:**

**BEFORE Line 21:**
```
    Node 10
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â†  â”‚ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â–²            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         Still points to itself
```

**Executing Line 21:**
```
last.next = new_node

Step 1: Evaluate right side
    new_node â†’ 0x2B3C4D (Node 5)

Step 2: Assign to left side
    last.next â† 0x2B3C4D

Result: Node 10's next now points to Node 5
```

**AFTER Line 21:**
```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
                â–²  â”‚              â”‚
                â”‚  â”‚              â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ Node 10
                â”‚                 â”‚
       self.head                  â”‚
           â”‚                      â”‚
           â–¼                      â”‚
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”              â”‚
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”           â”‚
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚           â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚           â”‚
      â–²                â”‚           â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      
      last.next = new_node
      (Node 10 now points forward to Node 5)
```

**Circular Structure Now Complete!**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 21 - CIRCULAR COMPLETE!  â”‚
â”‚                                      â”‚
â”‚  NODE 5:                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ prev   â”‚0x1A2B3Câ”‚ â”€â”€â”€â”            â”‚
â”‚  â”‚ data   â”‚   5    â”‚    â”‚            â”‚
â”‚  â”‚ next   â”‚0x1A2B3Câ”‚ â”€â”€â”€â”¼â”€â”€â”         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚         â”‚
â”‚       â–²                 â”‚  â”‚         â”‚
â”‚       â”‚                 â”‚  â”‚         â”‚
â”‚       â”‚  NODE 10:       â”‚  â”‚         â”‚
â”‚       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¼â”€â”€â”¤         â”‚
â”‚       â””â”€â”€â”‚ prev   â”‚0x2B3C4Dâ”‚         â”‚
â”‚          â”‚ data   â”‚  10    â”‚         â”‚
â”‚       â”Œâ”€â”€â”‚ next   â”‚0x2B3C4Dâ”‚         â”‚
â”‚       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                      â”‚
â”‚  âœ… Doubly circular complete!        â”‚
â”‚  Forward:  5 â†’ 10 â†’ 5 â†’ 10 â†’ ...     â”‚
â”‚  Backward: 5 â† 10 â† 5 â† 10 â† ...     â”‚
â”‚                                      â”‚
â”‚  But HEAD still points to 10!        â”‚
â”‚  Need to update HEAD to 5            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 24: Update HEAD to New Node

```python
self.head = new_node
```

**What it does:**
- Moves `self.head` to point to the new node (Node 5)
- Makes Node 5 the official first node
- Completes the insertion at beginning

**Visual Explanation:**

**BEFORE Line 24:**
```
       self.head (still at Node 10)
           â”‚
           â–¼
       [Node 10]
```

**Executing Line 24:**
```
self.head = new_node

Step 1: Evaluate right side
    new_node â†’ 0x2B3C4D (Node 5)

Step 2: Assign to left side
    self.head â† 0x2B3C4D

Result: HEAD now points to Node 5
```

**AFTER Line 24:**
```
                   self.head (moved here!)
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
                â–²  â”‚              â”‚
                â”‚  â”‚              â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ Node 10
                â”‚                 â”‚
                â”‚                 â”‚
                â”‚                 â–¼
                â”‚          â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
                â”‚          â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
                â”‚          â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                â”‚          â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                â”‚               â–²             â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                              â””â”€â”€â†’
```

**Complete Final Structure:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  INSERTION COMPLETE!                 â”‚
â”‚                                      â”‚
â”‚       self.head                      â”‚
â”‚           â”‚                          â”‚
â”‚           â–¼                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”                â”‚
â”‚   â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚                â”‚
â”‚        â–²             â”‚                â”‚
â”‚        â”‚             â–¼                â”‚
â”‚        â”‚     â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”        â”‚
â”‚        â””â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”     â”‚
â”‚              â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚     â”‚
â”‚              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚                   â–²             â”‚     â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                      â”‚
â”‚  âœ… HEAD points to Node 5            â”‚
â”‚  âœ… Doubly circular maintained       â”‚
â”‚  âœ… Forward:  5 â†’ 10 â†’ (back to 5)   â”‚
â”‚  âœ… Backward: 5 â† 10 â† (back to 5)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FINAL STATE                 â”‚
â”‚                              â”‚
â”‚  self.head â†’ 0x2B3C4D (5)    â”‚
â”‚                              â”‚
â”‚  NODE 5:                     â”‚
â”‚  â€¢ prev â†’ Node 10            â”‚
â”‚  â€¢ data â†’ 5                  â”‚
â”‚  â€¢ next â†’ Node 10            â”‚
â”‚                              â”‚
â”‚  NODE 10:                    â”‚
â”‚  â€¢ prev â†’ Node 5             â”‚
â”‚  â€¢ data â†’ 10                 â”‚
â”‚  â€¢ next â†’ Node 5             â”‚
â”‚                              â”‚
â”‚  Perfect doubly circular!    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 25: Print Confirmation

```python
print(value, "inserted at beginning")
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                       â”‚
â”‚                                 â”‚
â”‚  5 inserted at beginning        â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Final State After Second Insertion

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚           â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                   â””â”€â”€â†’

Doubly Circular Linked List:
â€¢ Forward:  5 â†’ 10 â†’ (back to 5)
â€¢ Backward: 5 â† 10 â† (back to 5)
â€¢ Total nodes: 2
â€¢ HEAD points to: Node 5
```

---

## Summary of Execution Paths

### **Path 1: Empty List (value = 10)**
```
Lines Executed: 1, 2, 4, 6, 7, 8, 9, 10
Result: Single node pointing to itself
        10 â‡„ (back to 10)
```

### **Path 2: Non-Empty List (value = 5)**
```
Lines Executed: 1, 2, 4, 13, 16, 17, 20, 21, 24, 25
Result: New node inserted at beginning
        5 â‡„ 10 â‡„ (back to 5)
```

---

## Key Advantages Demonstrated

### **1. O(1) Access to Last Node**
```python
last = self.head.prev  # Direct access!
# No traversal needed!
```

### **2. Four Pointer Updates**
```python
new_node.next = self.head    # Line 16
new_node.prev = last         # Line 17
self.head.prev = new_node    # Line 20
last.next = new_node         # Line 21
```

### **3. Maintains Both Directions**
```
Forward circular:  new â†’ head â†’ ... â†’ last â†’ new
Backward circular: new â† head â† ... â† last â† new
```

---

## Complete Flow Chart

```
                    START
                      â”‚
                      â–¼
              [Create new_node]
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Is list empty?     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                â”‚
             YES              NO
              â”‚                â”‚
              â–¼                â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ self.head =  â”‚  â”‚ last =       â”‚
      â”‚  new_node    â”‚  â”‚  head.prev   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â–¼               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚new_node.next â”‚  â”‚new_node.next â”‚
      â”‚ = new_node   â”‚  â”‚ = self.head  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â–¼               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚new_node.prev â”‚  â”‚new_node.prev â”‚
      â”‚ = new_node   â”‚  â”‚ = last       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â–¼               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚Print & Returnâ”‚  â”‚head.prev =   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ new_node     â”‚
              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â”‚               â–¼
              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚         â”‚last.next =   â”‚
              â”‚         â”‚ new_node     â”‚
              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â”‚               â–¼
              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚         â”‚self.head =   â”‚
              â”‚         â”‚ new_node     â”‚
              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â”‚               â–¼
              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚         â”‚Print message â”‚
              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
                     END
```

---

## ğŸ‰ Complete Understanding!

**You now understand:**
- âœ… Empty list handling (self-circular)
- âœ… **O(1) last node access via `head.prev`**
- âœ… Four critical pointer updates
- âœ… Maintaining both forward and backward circular links
- âœ… Why doubly circular is most efficient for insertions

**Key Insight:** Doubly circular combines the best of both worlds - bidirectional access AND circular structure! ğŸ”„â‡„


# Complete Line-by-Line Explanation: Insert at End (Doubly Circular Linked List)

I'll provide an extremely detailed explanation with comprehensive diagrams.

---

## Complete Code with Line Numbers

```python
def insert_end(self, value):                # Line 1
    new_node = Node(value)                  # Line 2
                                            # Line 3 (blank)
    if self.head is None:                   # Line 4
        # Empty list - node points to itself  # Line 5 (comment)
        self.head = new_node                # Line 6
        new_node.next = new_node            # Line 7
        new_node.prev = new_node            # Line 8
        print(value, "inserted as first node")  # Line 9
        return                              # Line 10
                                            # Line 11 (blank)
    # Last node is head.prev (advantage of doubly circular!)  # Line 12 (comment)
    last = self.head.prev                   # Line 13
                                            # Line 14 (blank)
    # Connect new node                      # Line 15 (comment)
    new_node.next = self.head               # Line 16
    new_node.prev = last                    # Line 17
                                            # Line 18 (blank)
    # Update connections                    # Line 19 (comment)
    last.next = new_node                    # Line 20
    self.head.prev = new_node               # Line 21
                                            # Line 22 (blank)
    print(value, "inserted at end")         # Line 23
```

---

# SCENARIO 1: INSERT INTO EMPTY LIST

Let's insert **10** into an empty doubly circular linked list.

---

## Initial State: Empty List

```
self.head = None

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DOUBLY CIRCULAR LINKED LIST        â”‚
â”‚  Status: EMPTY                      â”‚
â”‚                                     â”‚
â”‚  No nodes exist                     â”‚
â”‚  self.head points to None           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 1: Function Definition

```python
def insert_end(self, value):
```

**Function Call:**
```
insert_end(10)
           â”‚
           â””â”€â”€â”€ value = 10
```

**Visual:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FUNCTION CALLED             â”‚
â”‚  insert_end(10)              â”‚
â”‚                              â”‚
â”‚  Parameters:                 â”‚
â”‚  â€¢ self: DoublyCircular...   â”‚
â”‚  â€¢ value: 10                 â”‚
â”‚                              â”‚
â”‚  Task: Insert 10 at END      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 2: Create New Node

```python
new_node = Node(value)
```

**What it does:**
- Creates a new `Node` object with data = 10
- Initializes: `prev = None`, `data = 10`, `next = None`

**Diagram AFTER Line 2:**

```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     NODE      â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ prev:  NULL   â”‚
              â”‚ data:   10    â”‚
              â”‚ next:  NULL   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


       self.head = None
```

---

## LINES 4-10: Handle Empty List (Same as insert_beginning)

Since the process is identical to `insert_beginning` for empty lists, I'll show the result:

**After executing lines 4-10:**

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â–²  â”‚            â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â–¼

Console Output: "10 inserted as first node"

List: 10 â‡„ (back to 10)
Function exits (return)
```

---

---

# SCENARIO 2: INSERT INTO NON-EMPTY LIST

Now let's insert **20** at the **END** of the existing list: **5 â‡„ 10 â‡„ (back to 5)**

This is where `insert_end` differs from `insert_beginning`!

---

## Initial State: List with Two Nodes

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚           â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                   â””â”€â”€â†’

Current List:
â€¢ Forward:  5 â†’ 10 â†’ (back to 5)
â€¢ Backward: 5 â† 10 â† (back to 5)
â€¢ HEAD: Node 5
â€¢ LAST: Node 10 (head.prev)

Goal: Insert 20 at END
Expected: 5 â‡„ 10 â‡„ 20 â‡„ (back to 5)
```

---

## LINE 1: Function Definition

```python
def insert_end(self, value):
```

**Function Call:**
```
insert_end(20)
           â”‚
           â””â”€â”€â”€ value = 20
```

---

## LINE 2: Create New Node

```python
new_node = Node(value)
```

**Diagram AFTER Line 2:**

```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     NODE      â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ prev:  NULL   â”‚
              â”‚ data:   20    â”‚
              â”‚ next:  NULL   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â” (Existing nodes)
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚           â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                   â””â”€â”€â†’
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  THREE SEPARATE NODES        â”‚
â”‚                              â”‚
â”‚  NEW NODE (not in list):     â”‚
â”‚  Address: 0x3C4D5E           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚  NULL  â”‚         â”‚
â”‚  â”‚ data   â”‚   20   â”‚         â”‚
â”‚  â”‚ next   â”‚  NULL  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  EXISTING NODES:             â”‚
â”‚  Node 5 (head): 0x2B3C4D     â”‚
â”‚  Node 10 (last): 0x1A2B3C    â”‚
â”‚                              â”‚
â”‚  self.head â†’ 0x2B3C4D        â”‚
â”‚  new_node  â†’ 0x3C4D5E        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 4: Check if List is Empty

```python
if self.head is None:
```

**In Our Case:**
```
self.head = 0x2B3C4D (points to Node 5)

Evaluation:
self.head is None â†’ 0x2B3C4D is None â†’ FALSE âœ—

Action: Skip lines 6-10
        Jump to line 13
```

**Visual Decision:**
```
                LINE 4
                  â”‚
                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Is list empty?  â”‚
        â”‚ self.head?      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
          â”‚               â”‚
         YES             NO â† We go this way
          â”‚               â”‚
          â–¼               â–¼
    Lines 6-10       Lines 13-23
    (SKIP)           (EXECUTE)
```

---

## LINE 13: Find Last Node (O(1) Operation!)

```python
last = self.head.prev
```

**What it does:**
- Directly accesses the last node via `self.head.prev`
- **This is the KEY ADVANTAGE of doubly circular lists!**
- **O(1) time complexity** - no traversal needed!

**Why This Works:**
```
In doubly circular list:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  head.prev ALWAYS points to      â”‚
â”‚  the LAST node!                  â”‚
â”‚                                  â”‚
â”‚  This is maintained by all       â”‚
â”‚  insert/delete operations        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Visual Explanation:**

**BEFORE Line 13:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
      â–²  â”‚              â”‚
      â”‚  â”‚              â–¼
      â”‚  â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
      â”‚  â””â”€â”€â”€â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
      â”‚         â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
      â”‚         â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â”‚              â–²             â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
      self.head.prev                â”‚
      (points to last node - Node 10)
```

**Executing Line 13:**
```
last = self.head.prev

Step 1: Access self.head
    self.head â†’ 0x2B3C4D (Node 5)

Step 2: Access self.head.prev
    Node 5's prev â†’ 0x1A2B3C (Node 10)

Step 3: Assign to last
    last â† 0x1A2B3C (Node 10)

Result: last points to Node 10 (the last node)
Time: O(1) - Direct access!
```

**AFTER Line 13:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
      â–²  â”‚              â”‚
      â”‚  â”‚              â–¼
      â”‚  â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â” â† last
      â”‚  â””â”€â”€â”€â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
      â”‚         â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
      â”‚         â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â”‚              â–²             â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                   â””â”€â”€â†’
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 13               â”‚
â”‚                              â”‚
â”‚  new_node  â†’ 0x3C4D5E (20)   â”‚
â”‚  self.head â†’ 0x2B3C4D (5)    â”‚
â”‚  last      â†’ 0x1A2B3C (10)   â”‚
â”‚                              â”‚
â”‚  âœ… Found last node in O(1)! â”‚
â”‚  âœ… No traversal needed!     â”‚
â”‚                              â”‚
â”‚  Compare to singly circular: â”‚
â”‚  Would need O(n) traversal   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Comparison: Singly vs Doubly Circular**
```
SINGLY CIRCULAR (O(n)):
    temp = self.head
    while temp.next != self.head:
        temp = temp.next
    # Now temp is last node
    
DOUBLY CIRCULAR (O(1)):
    last = self.head.prev
    # Already have last node!
```

---

## LINE 16: Connect New Node's Next to Head

```python
new_node.next = self.head
```

**What it does:**
- Makes new node's `next` pointer point to the head (Node 5)
- When inserted at end, new node will wrap around to point back to beginning
- Creates the forward circular link from new last node to head

**Visual Explanation:**

**BEFORE Line 16:**
```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚NULLâ”‚ 20 â”‚NULLâ”‚  â† next is NULL
              â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜


       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
```

**Executing Line 16:**
```
new_node.next = self.head

Step 1: Evaluate right side
    self.head â†’ 0x2B3C4D (Node 5)

Step 2: Assign to left side
    new_node.next â† 0x2B3C4D

Result: New node's next points to head (Node 5)
```

**AFTER Line 16:**
```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚NULLâ”‚ 20 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
                                  â”‚ new_node.next = self.head
       self.head                  â”‚
           â”‚                      â”‚
           â–¼                      â”‚
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”              â”‚
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”         â”‚
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚         â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚         â”‚
         â–²  â”‚           â”‚         â”‚
         â”‚  â”‚           â–¼         â”‚
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”  â”‚
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”¼â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚  â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚  â”‚
         â”‚       â–²  last           â”‚  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚  â”‚
                                   â””â”€â”€â”˜
                                   
                                   â–¼
                              [Points to Node 5]
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 16               â”‚
â”‚                              â”‚
â”‚  NODE 20:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚  NULL  â”‚         â”‚
â”‚  â”‚ data   â”‚   20   â”‚         â”‚
â”‚  â”‚ next   â”‚0x2B3C4Dâ”‚ â”€â”€â†’ 5   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  âœ… Forward link created     â”‚
â”‚  âŒ Still need backward link â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 17: Connect New Node's Prev to Last

```python
new_node.prev = last
```

**What it does:**
- Makes new node's `prev` pointer point to the current last node (Node 10)
- Creates backward link from new node to the old last node

**Visual Explanation:**

**BEFORE Line 17:**
```
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚NULLâ”‚ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’ Node 5
              â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                â–²
                â””â”€â”€â”€ Still NULL
```

**Executing Line 17:**
```
new_node.prev = last

Step 1: Evaluate right side
    last â†’ 0x1A2B3C (Node 10)

Step 2: Assign to left side
    new_node.prev â† 0x1A2B3C

Result: New node's prev points to Node 10
```

**AFTER Line 17:**
```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
                â–²  â”‚              â”‚
                â”‚  â”‚              â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ Node 5
                â”‚                 â”‚
       self.head                  â”‚
           â”‚                      â”‚
           â–¼                      â”‚
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”              â”‚
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”         â”‚
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚         â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚         â”‚
         â–²  â”‚           â”‚         â”‚
         â”‚  â”‚           â–¼         â”‚
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”  â”‚
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”¼â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚  â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚  â”‚
         â”‚       â–²  â”‚ last         â”‚  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
         new_node.prev = last (Node 10)â”‚
                                       â–¼
                                  [Points to Node 5]
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 17               â”‚
â”‚                              â”‚
â”‚  NODE 20:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x1A2B3Câ”‚ â”€â”€â†’ 10  â”‚
â”‚  â”‚ data   â”‚   20   â”‚         â”‚
â”‚  â”‚ next   â”‚0x2B3C4Dâ”‚ â”€â”€â†’ 5   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚       â–²           â”‚           â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚   Both pointers set           â”‚
â”‚                              â”‚
â”‚  âœ… New node fully prepared  â”‚
â”‚  âŒ But existing nodes       â”‚
â”‚     don't know about it yet! â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 20: Update Last's Next to New Node

```python
last.next = new_node
```

**What it does:**
- Makes the current last node (Node 10) point forward to the new node (Node 20)
- Inserts new node into the forward chain

**Visual Explanation:**

**BEFORE Line 20:**
```
                        last
                         â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
                   â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”
                   â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                        â”‚             â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    Still points back to Node 5
```

**Executing Line 20:**
```
last.next = new_node

Step 1: Evaluate right side
    new_node â†’ 0x3C4D5E (Node 20)

Step 2: Assign to left side
    last.next â† 0x3C4D5E

Result: Node 10's next now points to Node 20
```

**AFTER Line 20:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²  last         â”‚
         â”‚           â”‚               â”‚
         â”‚           â”‚               â–¼
         â”‚           â”‚       â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                   â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                        â”‚             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                â””â”€â”€â†’ Node 5
         
         last.next = new_node
         (Node 10 now points to Node 20)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 20               â”‚
â”‚                              â”‚
â”‚  NODE 10:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x2B3C4Dâ”‚ â”€â”€â†’ 5   â”‚
â”‚  â”‚ data   â”‚  10    â”‚         â”‚
â”‚  â”‚ next   â”‚0x3C4D5Eâ”‚ â”€â”€â†’ 20  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  NODE 20:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x1A2B3Câ”‚ â”€â”€â†’ 10  â”‚
â”‚  â”‚ data   â”‚   20   â”‚         â”‚
â”‚  â”‚ next   â”‚0x2B3C4Dâ”‚ â”€â”€â†’ 5   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  âœ… Forward chain updated    â”‚
â”‚  âŒ HEAD's prev still points â”‚
â”‚     to old last (Node 10)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 21: Update Head's Prev to New Node

```python
self.head.prev = new_node
```

**What it does:**
- Makes the head (Node 5) point backward to the new node (Node 20)
- Completes the circular backward link
- Makes Node 20 the new last node

**Visual Explanation:**

**BEFORE Line 21:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
      â–²
      â””â”€â”€â”€â”€ Still points to Node 10 (old last)
```

**Executing Line 21:**
```
self.head.prev = new_node

Step 1: Evaluate right side
    new_node â†’ 0x3C4D5E (Node 20)

Step 2: Assign to left side
    self.head.prev â† 0x3C4D5E

Result: Node 5's prev now points to Node 20
```

**AFTER Line 21:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
      â–²  â”‚              â”‚
      â”‚  â”‚              â–¼
      â”‚  â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
      â”‚  â””â”€â”€â”€â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
      â”‚         â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
      â”‚         â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
      â”‚              â–²              â”‚
      â”‚              â”‚              â–¼
      â”‚              â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
      â”‚              â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
      â”‚                     â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
      â”‚                     â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
      â”‚                          â–²             â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
      self.head.prev = new_node                â”‚
      (Head now points back to Node 20)        â”‚
                                                â””â”€â”€â†’
```

**Complete Circular Structure:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  INSERTION COMPLETE!                 â”‚
â”‚                                      â”‚
â”‚       self.head                      â”‚
â”‚           â”‚                          â”‚
â”‚           â–¼                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”                â”‚
â”‚   â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚                â”‚
â”‚        â–²             â”‚                â”‚
â”‚        â”‚             â–¼                â”‚
â”‚        â”‚     â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”        â”‚
â”‚        â”‚     â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”     â”‚
â”‚        â”‚     â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚     â”‚
â”‚        â”‚     â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚        â”‚          â–²             â”‚     â”‚
â”‚        â”‚          â”‚             â–¼     â”‚
â”‚        â”‚          â”‚     â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚        â”‚          â””â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
â”‚        â”‚                â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
â”‚        â”‚                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                     â–²             â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                            â””â”€â”€â†’
â”‚                                      â”‚
â”‚  âœ… Doubly circular complete!        â”‚
â”‚  âœ… Forward:  5 â†’ 10 â†’ 20 â†’ (5)      â”‚
â”‚  âœ… Backward: 5 â† 10 â† 20 â† (5)      â”‚
â”‚  âœ… HEAD unchanged (still Node 5)    â”‚
â”‚  âœ… New last node is Node 20         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FINAL STATE                 â”‚
â”‚                              â”‚
â”‚  self.head â†’ 0x2B3C4D (5)    â”‚
â”‚                              â”‚
â”‚  NODE 5 (HEAD):              â”‚
â”‚  â€¢ prev â†’ Node 20 (NEW!)     â”‚
â”‚  â€¢ data â†’ 5                  â”‚
â”‚  â€¢ next â†’ Node 10            â”‚
â”‚                              â”‚
â”‚  NODE 10 (MIDDLE):           â”‚
â”‚  â€¢ prev â†’ Node 5             â”‚
â”‚  â€¢ data â†’ 10                 â”‚
â”‚  â€¢ next â†’ Node 20 (NEW!)     â”‚
â”‚                              â”‚
â”‚  NODE 20 (LAST):             â”‚
â”‚  â€¢ prev â†’ Node 10            â”‚
â”‚  â€¢ data â†’ 20                 â”‚
â”‚  â€¢ next â†’ Node 5             â”‚
â”‚                              â”‚
â”‚  Perfect doubly circular!    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 23: Print Confirmation

```python
print(value, "inserted at end")
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                       â”‚
â”‚                                 â”‚
â”‚  20 inserted at end             â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Final State After Insertion

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²              â”‚
         â”‚           â”‚              â–¼
         â”‚           â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                  â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                       â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                               â””â”€â”€â†’

Doubly Circular Linked List:
â€¢ Forward:  5 â†’ 10 â†’ 20 â†’ (back to 5)
â€¢ Backward: 5 â† 10 â† 20 â† (back to 5)
â€¢ Total nodes: 3
â€¢ HEAD: Node 5 (unchanged)
â€¢ LAST: Node 20 (NEW - accessible via head.prev)
```

**Verification:**
```
âœ… self.head still points to Node 5
âœ… self.head.prev now points to Node 20 (new last)
âœ… Node 20.next points to Node 5 (circular forward)
âœ… Node 5.prev points to Node 20 (circular backward)
âœ… All nodes properly linked in both directions
```

---

## Key Differences: insert_beginning vs insert_end

| Aspect | insert_beginning | insert_end |
|--------|------------------|------------|
| **What changes** | HEAD pointer | Last node (head.prev) |
| **HEAD updated?** | âœ… Yes (Line 24) | âŒ No |
| **New node becomes** | First node | Last node |
| **Four connections** | Same pattern | Same pattern |
| **Result** | new â†’ old_head â†’ ... â†’ last â†’ new | head â†’ ... â†’ old_last â†’ new â†’ head |

**Both use the same connection pattern:**
```
1. new_node.next = self.head
2. new_node.prev = last
3. last.next = new_node
4. self.head.prev = new_node

Difference: insert_beginning adds:
5. self.head = new_node  (â† This line!)
```

---

## Execution Comparison

### **insert_beginning(5) on list [10]:**
```
Before: 10 â‡„ (back to 10)
After:  5 â‡„ 10 â‡„ (back to 5)
        â†‘
        HEAD moved here
```

### **insert_end(20) on list [5, 10]:**
```
Before: 5 â‡„ 10 â‡„ (back to 5)
        â†‘
        HEAD stays here
        
After:  5 â‡„ 10 â‡„ 20 â‡„ (back to 5)
        â†‘              â†‘
        HEAD          NEW LAST
```

---

## Summary of Execution Paths

### **Path 1: Empty List (value = 10)**
```
Lines Executed: 1, 2, 4, 6, 7, 8, 9, 10
Result: Single self-circular node
        10 â‡„ (back to 10)
```

### **Path 2: Non-Empty List (value = 20)**
```
Lines Executed: 1, 2, 4, 13, 16, 17, 20, 21, 23
Result: New node inserted at end, HEAD unchanged
        5 â‡„ 10 â‡„ 20 â‡„ (back to 5)
```

---

## Advantages Highlighted

### **1. O(1) Last Node Access**
```python
last = self.head.prev  # Line 13
# Instant access - no traversal!
```

### **2. No HEAD Change Needed**
```python
# Unlike insert_beginning, we DON'T do:
# self.head = new_node

# HEAD stays at Node 5
# New node becomes new last (accessible via head.prev)
```

### **3. Symmetric Operations**
```
Both insert_beginning and insert_end:
â€¢ Use same 4 pointer updates
â€¢ Take O(1) time
â€¢ Maintain doubly circular structure

Only difference: HEAD update
```

---

## Complete Flow Chart

```
                    START
                      â”‚
                      â–¼
              [Create new_node]
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Is list empty?     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                â”‚
             YES              NO
              â”‚                â”‚
              â–¼                â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ self.head =  â”‚  â”‚ last =       â”‚
      â”‚  new_node    â”‚  â”‚  head.prev   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â–¼               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚new_node.next â”‚  â”‚new_node.next â”‚
      â”‚ = new_node   â”‚  â”‚ = self.head  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â–¼               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚new_node.prev â”‚  â”‚new_node.prev â”‚
      â”‚ = new_node   â”‚  â”‚ = last       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â–¼               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚Print & Returnâ”‚  â”‚last.next =   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ new_node     â”‚
              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â”‚               â–¼
              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚         â”‚head.prev =   â”‚
              â”‚         â”‚ new_node     â”‚
              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â”‚               â–¼
              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚         â”‚Print message â”‚
              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
                     END
```

---

## ğŸ‰ Complete Understanding!

**You now understand:**
- âœ… Empty list handling (identical to insert_beginning)
- âœ… **O(1) last node access via `head.prev`** (KEY ADVANTAGE!)
- âœ… Four pointer updates (same as insert_beginning)
- âœ… Why HEAD doesn't change (unlike insert_beginning)
- âœ… How new node becomes new last node
- âœ… Maintaining doubly circular structure

**Key Insight:** 
```
insert_end is nearly identical to insert_beginning
but SKIPS the "self.head = new_node" update!

Result: New node added at end, HEAD stays at beginning
```

**Why doubly circular is superior:**
```
Singly Circular:  O(n) to find last
Doubly Circular:  O(1) to find last (head.prev)

This makes insert_end equally efficient as insert_beginning! ğŸš€
```


# Complete Line-by-Line Explanation: Insert After a Given Value (Doubly Circular Linked List)

I'll provide an extremely detailed explanation with comprehensive diagrams.

---

## Complete Code with Line Numbers

```python
def insert_after(self, prev_value, value):  # Line 1
    if self.head is None:                   # Line 2
        print("List is empty")              # Line 3
        return                              # Line 4
                                            # Line 5 (blank)
    temp = self.head                        # Line 6
                                            # Line 7 (blank)
    while True:                             # Line 8
        if temp.data == prev_value:         # Line 9
            new_node = Node(value)          # Line 10
                                            # Line 11 (blank)
            # Connect new node               # Line 12 (comment)
            new_node.next = temp.next       # Line 13
            new_node.prev = temp            # Line 14
                                            # Line 15 (blank)
            # Update surrounding nodes       # Line 16 (comment)
            temp.next.prev = new_node       # Line 17
            temp.next = new_node            # Line 18
                                            # Line 19 (blank)
            print(value, "inserted after", prev_value)  # Line 20
            return                          # Line 21
                                            # Line 22 (blank)
        temp = temp.next                    # Line 23
        if temp == self.head:               # Line 24
            break                           # Line 25
                                            # Line 26 (blank)
    print("Value", prev_value, "not found")  # Line 27
```

---

# MAIN SCENARIO: Insert 25 After 10

Let's insert **25** after **10** in the list: **5 â‡„ 10 â‡„ 20 â‡„ (back to 5)**

---

## Initial State

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²              â”‚
         â”‚           â”‚              â–¼
         â”‚           â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                  â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                       â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                               â””â”€â”€â†’

Current List:
â€¢ Forward:  5 â†’ 10 â†’ 20 â†’ (back to 5)
â€¢ Backward: 5 â† 10 â† 20 â† (back to 5)

Goal: Insert 25 after 10
Expected: 5 â‡„ 10 â‡„ 25 â‡„ 20 â‡„ (back to 5)
```

---

## LINE 1: Function Definition

```python
def insert_after(self, prev_value, value):
```

**Function Call:**
```
insert_after(10, 25)
             â”‚   â”‚
             â”‚   â””â”€â”€â”€ value = 25 (new value to insert)
             â””â”€â”€â”€â”€â”€â”€â”€ prev_value = 10 (insert after this)
```

**Visual:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FUNCTION CALLED                 â”‚
â”‚  insert_after(10, 25)            â”‚
â”‚                                  â”‚
â”‚  Parameters:                     â”‚
â”‚  â€¢ self: DoublyCircularLinkedListâ”‚
â”‚  â€¢ prev_value: 10                â”‚
â”‚  â€¢ value: 25                     â”‚
â”‚                                  â”‚
â”‚  Task: Find node with value 10,  â”‚
â”‚        then insert 25 after it   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 2: Check if List is Empty

```python
if self.head is None:
```

**What it does:**
- Checks if the list has any nodes
- Can't insert after a value if list is empty

**In Our Case:**
```
self.head = 0x2B3C4D (points to Node 5)

Evaluation:
self.head is None â†’ 0x2B3C4D is None â†’ FALSE âœ—

Action: Skip lines 3-4
        Continue to line 6
```

**Visual Decision:**
```
                LINE 2
                  â”‚
                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Is list empty?  â”‚
        â”‚ self.head?      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
          â”‚               â”‚
         YES             NO â† We go this way
          â”‚               â”‚
          â–¼               â–¼
    Lines 3-4         Line 6
    (Print "empty")   (Continue)
    (SKIP)
```

**Note:** If list was empty:
```
Lines 3-4 would execute:
    print("List is empty")
    return

Output: "List is empty"
Function exits
```

---

## LINE 6: Initialize Traversal Pointer

```python
temp = self.head
```

**What it does:**
- Creates a reference `temp` pointing to the first node
- Will be used to traverse the list searching for `prev_value` (10)

**Diagram AFTER Line 6:**

```
    self.head
    temp          (both point to same node)
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Searching for: prev_value = 10
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 6                â”‚
â”‚                              â”‚
â”‚  self.head â†’ 0x2B3C4D (5)    â”‚
â”‚  temp      â†’ 0x2B3C4D (5)    â”‚
â”‚  prev_value â†’ 10             â”‚
â”‚  value â†’ 25                  â”‚
â”‚                              â”‚
â”‚  Ready to search for 10      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 8: Start Infinite Loop

```python
while True:
```

**What it does:**
- Starts an infinite loop
- Will manually break when:
  1. We find the value (Line 21 - return)
  2. We complete full circle (Line 25 - break)

**Why `while True` instead of `while temp`?**
```
In circular lists, temp is NEVER None!
Every node points to another node.

So we can't use: while temp != None

Instead: while True with manual break condition
```

**Loop Structure:**
```
while True:
    # Check if current node matches
    if temp.data == prev_value:
        # Found it! Insert and return
    
    # Move to next node
    temp = temp.next
    
    # Check if we've completed the circle
    if temp == self.head:
        break  # Not found
```

---

## ITERATION 1: temp at Node 5

### **LINE 9: Check if Current Node Matches**

```python
if temp.data == prev_value:
```

**What it does:**
- Checks if the current node contains the value we're searching for

**Evaluation:**
```
         temp
          â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

temp.data = 5
prev_value = 10

Check: 5 == 10?
Result: FALSE âœ—

Action: Skip lines 10-21 (insertion logic)
        Continue to line 23
```

**Visual:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ITERATION 1                 â”‚
â”‚                              â”‚
â”‚  temp at: Node 5             â”‚
â”‚  temp.data: 5                â”‚
â”‚  prev_value: 10              â”‚
â”‚                              â”‚
â”‚  5 == 10? NO âœ—               â”‚
â”‚                              â”‚
â”‚  Action: Skip insertion,     â”‚
â”‚          move to next node   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **LINE 23: Move to Next Node**

```python
temp = temp.next
```

**What it does:**
- Moves `temp` to the next node in the list

**Execution:**
```
Before: temp at Node 5
        temp.next = Node 10

After:  temp = temp.next
        temp now at Node 10
```

**Diagram AFTER Line 23:**
```
    self.head
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”          temp
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”      â–¼
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â””â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
         â–²                â”‚ â†  â”‚    â”‚ â†’  â”‚
         â”‚                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â”€â”€ temp moved here
```

---

### **LINE 24: Check if Completed Circle**

```python
if temp == self.head:
```

**What it does:**
- Checks if we've gone full circle back to the starting point
- If yes, the value wasn't found

**Evaluation:**
```
temp = Node 10 (0x1A2B3C)
self.head = Node 5 (0x2B3C4D)

Check: Node 10 == Node 5?
Result: FALSE âœ—

Action: Don't break, continue loop
        Go back to line 8 (next iteration)
```

**Visual:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CHECK CIRCLE COMPLETION     â”‚
â”‚                              â”‚
â”‚  temp: Node 10               â”‚
â”‚  self.head: Node 5           â”‚
â”‚                              â”‚
â”‚  temp == self.head?          â”‚
â”‚  10 == 5? NO âœ—               â”‚
â”‚                              â”‚
â”‚  Not back at start yet       â”‚
â”‚  Continue searching...       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Loop continues...**

---

## ITERATION 2: temp at Node 10

### **LINE 9: Check if Current Node Matches**

```python
if temp.data == prev_value:
```

**Evaluation:**
```
         temp
          â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

temp.data = 10
prev_value = 10

Check: 10 == 10?
Result: TRUE âœ“ (FOUND!)

Action: Execute insertion logic (lines 10-21)
```

**Visual:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ITERATION 2                 â”‚
â”‚                              â”‚
â”‚  temp at: Node 10            â”‚
â”‚  temp.data: 10               â”‚
â”‚  prev_value: 10              â”‚
â”‚                              â”‚
â”‚  10 == 10? YES! âœ“            â”‚
â”‚                              â”‚
â”‚  FOUND THE NODE!             â”‚
â”‚  Execute insertion...        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 10: Create New Node

```python
new_node = Node(value)
```

**What it does:**
- Creates a new node with data = 25
- Initializes: `prev = None`, `data = 25`, `next = None`

**Diagram AFTER Line 10:**

```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     NODE      â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ prev:  NULL   â”‚
              â”‚ data:   25    â”‚
              â”‚ next:  NULL   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


                   temp
                    â–¼
    ... â”€â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’ ...
              â”‚ â†  â”‚    â”‚ â†’  â”‚     â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NEW NODE CREATED            â”‚
â”‚                              â”‚
â”‚  Address: 0x3C4D5E           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚  NULL  â”‚         â”‚
â”‚  â”‚ data   â”‚   25   â”‚         â”‚
â”‚  â”‚ next   â”‚  NULL  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  Need to insert between      â”‚
â”‚  Node 10 and Node 20         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Current Situation Before Insertion

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â” â† temp (found node)
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²              â”‚
         â”‚           â”‚              â–¼
         â”‚           â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                  â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                       â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                               â””â”€â”€â†’

Need to insert new_node (25) between temp (10) and temp.next (20)

Current connections to break/update:
â€¢ Node 10.next â†’ Node 20 (will point to new node)
â€¢ Node 20.prev â†’ Node 10 (will point to new node)
```

---

## LINE 13: Connect New Node's Next Forward

```python
new_node.next = temp.next
```

**What it does:**
- Makes new node's `next` pointer point to the node **after** temp (Node 20)
- Creates forward link from new node to the rest of the list

**Visual Explanation:**

**BEFORE Line 13:**
```
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚NULLâ”‚ 25 â”‚NULLâ”‚  â† next is NULL
              â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
```

**Executing Line 13:**
```
new_node.next = temp.next

Step 1: Evaluate right side
    temp â†’ Node 10
    temp.next â†’ Node 20 (0x4D5E6F)

Step 2: Assign to left side
    new_node.next â† 0x4D5E6F (Node 20)

Result: New node's next points to Node 20
```

**AFTER Line 13:**
```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚NULLâ”‚ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
                                  â”‚ new_node.next = temp.next
                   temp           â”‚
                    â–¼             â”‚
    ... â”€â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”   â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â†’â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’ ...
              â”‚ â†  â”‚    â”‚ â†’  â”‚   â”‚   â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜   â”‚   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                   â”‚             â”‚        â–²
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                    Both point to Node 20
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 13               â”‚
â”‚                              â”‚
â”‚  NODE 25:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚  NULL  â”‚         â”‚
â”‚  â”‚ data   â”‚   25   â”‚         â”‚
â”‚  â”‚ next   â”‚0x4D5E6Fâ”‚ â”€â”€â†’ 20  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  âœ… Forward link created     â”‚
â”‚  âŒ Backward link still NULL â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 14: Connect New Node's Prev Backward

```python
new_node.prev = temp
```

**What it does:**
- Makes new node's `prev` pointer point to temp (Node 10)
- Creates backward link from new node to the previous node

**Visual Explanation:**

**BEFORE Line 14:**
```
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚NULLâ”‚ 25 â”‚ â—â”€â”€â”¼â”€â”€â†’ Node 20
              â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                â–²
                â””â”€â”€â”€ Still NULL
```

**Executing Line 14:**
```
new_node.prev = temp

Step 1: Evaluate right side
    temp â†’ Node 10 (0x1A2B3C)

Step 2: Assign to left side
    new_node.prev â† 0x1A2B3C (Node 10)

Result: New node's prev points to Node 10
```

**AFTER Line 14:**
```
                   new_node
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
                â–²  â”‚              â”‚
                â”‚  â”‚              â”‚
                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ Node 20
                â”‚                 â”‚
                â”‚  temp           â”‚
                â”‚   â–¼             â”‚
    ... â”€â”€â”€â”€â”€â”€â”€â”€â”¼â†’â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
                â”‚ â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”¼â”€â”€â†’â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’ ...
                â”‚ â”‚ â†  â”‚    â”‚ â†’  â”‚â”‚   â”‚ â†  â”‚    â”‚ â†’  â”‚
                â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜â”‚   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                â”‚      â”‚          â”‚        â–²
                â””â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                new_node.prev = temp
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 14               â”‚
â”‚                              â”‚
â”‚  NODE 25:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x1A2B3Câ”‚ â”€â”€â†’ 10  â”‚
â”‚  â”‚ data   â”‚   25   â”‚         â”‚
â”‚  â”‚ next   â”‚0x4D5E6Fâ”‚ â”€â”€â†’ 20  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚       â–²           â”‚           â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚   New node fully prepared     â”‚
â”‚                              â”‚
â”‚  âœ… Both pointers set        â”‚
â”‚  âŒ But surrounding nodes    â”‚
â”‚     don't know about it yet! â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Current State After Lines 13-14

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â” â† temp
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²              â”‚
         â”‚           â”‚              â”‚
         â”‚           â”‚ new_node     â”‚
         â”‚           â”‚    â–¼         â”‚
         â”‚           â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚             â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚             â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                  â”‚             â”‚
         â”‚                  â”‚             â–¼
         â”‚                  â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚                  â””â”€â”€â”€â”€â”€â†’â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                         â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                         â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                              â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                      â””â”€â”€â†’

New node (25) has both pointers set:
â€¢ new_node.prev â†’ Node 10 âœ“
â€¢ new_node.next â†’ Node 20 âœ“

But surrounding nodes still have OLD connections:
â€¢ Node 10.next â†’ Node 20 (should be â†’ Node 25)
â€¢ Node 20.prev â†’ Node 10 (should be â†’ Node 25)
```

---

## LINE 17: Update Next Node's Prev Pointer

```python
temp.next.prev = new_node
```

**What it does:**
- Updates the **node after temp** (Node 20) to point backward to new node
- Fixes the backward link from Node 20

**Breaking it down:**
```
temp.next.prev = new_node

temp â†’ Node 10
temp.next â†’ Node 20
temp.next.prev â†’ Node 20's prev pointer

We're setting: Node 20's prev = new_node (Node 25)
```

**Visual Explanation:**

**BEFORE Line 17:**
```
                   temp.next
                       â–¼
                  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
                  â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’ ...
                  â”‚ â†  â”‚    â”‚ â†’  â”‚
                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                    â–²
                    â”‚
              Points to Node 10 (OLD)
```

**Executing Line 17:**
```
temp.next.prev = new_node

Step 1: Identify the target
    temp.next â†’ Node 20
    temp.next.prev â†’ Node 20's prev pointer

Step 2: Evaluate right side
    new_node â†’ 0x3C4D5E (Node 25)

Step 3: Assign
    Node 20's prev â† 0x3C4D5E (Node 25)

Result: Node 20 now points backward to Node 25
```

**AFTER Line 17:**
```
                        temp
                         â–¼
    ... â”€â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’ ...
              â”‚ â†  â”‚    â”‚ â†’  â”‚     â”‚ â†  â”‚    â”‚ â†’  â”‚     â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                   â”‚                    â–²                    â–²
                   â”‚                    â”‚                    â”‚
                   â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                                         
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Still OLD connection
                                                    (to be fixed in Line 18)

temp.next.prev = new_node
(Node 20 now points back to Node 25)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 17               â”‚
â”‚                              â”‚
â”‚  NODE 20:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ prev   â”‚0x3C4D5Eâ”‚ â”€â”€â†’ 25  â”‚
â”‚  â”‚        â”‚ (NEW!) â”‚         â”‚
â”‚  â”‚ data   â”‚   20   â”‚         â”‚
â”‚  â”‚ next   â”‚0x2B3C4Dâ”‚ â”€â”€â†’ 5   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚
â”‚  âœ… Backward link updated    â”‚
â”‚  âŒ Forward link from 10     â”‚
â”‚     still needs update       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 18: Update Previous Node's Next Pointer

```python
temp.next = new_node
```

**What it does:**
- Updates temp (Node 10) to point forward to new node
- Completes the insertion by fixing the forward link

**Visual Explanation:**

**BEFORE Line 18:**
```
                   temp
                    â–¼
              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ [Node 20]
              â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                   â”‚
              Still points to Node 20 (OLD)
              Should point to Node 25
```

**Executing Line 18:**
```
temp.next = new_node

Step 1: Identify the target
    temp â†’ Node 10
    temp.next â†’ Node 10's next pointer

Step 2: Evaluate right side
    new_node â†’ 0x3C4D5E (Node 25)

Step 3: Assign
    Node 10's next â† 0x3C4D5E (Node 25)

Result: Node 10 now points forward to Node 25
```

**AFTER Line 18:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²              â”‚
         â”‚           â”‚              â–¼
         â”‚           â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚                  â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚                       â–²              â”‚
         â”‚                       â”‚              â–¼
         â”‚                       â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚                       â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                              â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                                   â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                           â””â”€â”€â†’

temp.next = new_node
(Node 10 now points forward to Node 25)
```

**Complete Insertion:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  INSERTION COMPLETE!                 â”‚
â”‚                                      â”‚
â”‚  All four connections updated:       â”‚
â”‚                                      â”‚
â”‚  1. new_node.next = temp.next (13)   â”‚
â”‚     25 â†’ 20 âœ“                        â”‚
â”‚                                      â”‚
â”‚  2. new_node.prev = temp (14)        â”‚
â”‚     25 â† 10 âœ“                        â”‚
â”‚                                      â”‚
â”‚  3. temp.next.prev = new_node (17)   â”‚
â”‚     20 â† 25 âœ“                        â”‚
â”‚                                      â”‚
â”‚  4. temp.next = new_node (18)        â”‚
â”‚     10 â†’ 25 âœ“                        â”‚
â”‚                                      â”‚
â”‚  Result: 5 â‡„ 10 â‡„ 25 â‡„ 20 â‡„ (5)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FINAL STATE                 â”‚
â”‚                              â”‚
â”‚  NODE 10:                    â”‚
â”‚  â€¢ prev â†’ Node 5             â”‚
â”‚  â€¢ data â†’ 10                 â”‚
â”‚  â€¢ next â†’ Node 25 (NEW!)     â”‚
â”‚                              â”‚
â”‚  NODE 25:                    â”‚
â”‚  â€¢ prev â†’ Node 10            â”‚
â”‚  â€¢ data â†’ 25                 â”‚
â”‚  â€¢ next â†’ Node 20            â”‚
â”‚                              â”‚
â”‚  NODE 20:                    â”‚
â”‚  â€¢ prev â†’ Node 25 (NEW!)     â”‚
â”‚  â€¢ data â†’ 20                 â”‚
â”‚  â€¢ next â†’ Node 5             â”‚
â”‚                              â”‚
â”‚  Perfect insertion! âœ“        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 20: Print Confirmation

```python
print(value, "inserted after", prev_value)
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                       â”‚
â”‚                                 â”‚
â”‚  25 inserted after 10           â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 21: Exit Function

```python
return
```

**What it does:**
- Exits the function immediately
- Lines 23-27 will NOT be executed (value was found)

**Control Flow:**
```
Lines Executed: 1, 2, 6, 8, 9, 23, 24, 8, 9, 10, 13, 14, 17, 18, 20, 21
Lines Skipped: 3, 4, 23-27 (after return)
```

---

## Final State After Insertion

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²              â”‚
         â”‚           â”‚              â–¼
         â”‚           â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚                  â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚                       â–²              â”‚
         â”‚                       â”‚              â–¼
         â”‚                       â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚                       â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                              â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                                   â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                           â””â”€â”€â†’

Updated List:
â€¢ Forward:  5 â†’ 10 â†’ 25 â†’ 20 â†’ (back to 5)
â€¢ Backward: 5 â† 10 â† 25 â† 20 â† (back to 5)
â€¢ Total nodes: 4
â€¢ New node 25 inserted between 10 and 20
```

---

## SCENARIO: Value Not Found

What if we search for **100** (doesn't exist)?

### **Process:**

**Iteration 1:** temp at Node 5
- Check: 5 == 100? NO
- Move: temp = Node 10
- Circle check: 10 == 5? NO, continue

**Iteration 2:** temp at Node 10
- Check: 10 == 100? NO
- Move: temp = Node 20
- Circle check: 20 == 5? NO, continue

**Iteration 3:** temp at Node 25
- Check: 25 == 100? NO
- Move: temp = Node 20
- Circle check: 20 == 5? NO, continue

**Iteration 4:** temp at Node 20
- Check: 20 == 100? NO
- Move: temp = Node 5 (back to head!)
- **Circle check: 5 == 5? YES** â†’ **Break loop (Line 25)**

**LINE 27:** Print "Value 100 not found"

---

## Step-by-Step Insertion Animation

### **Step 0: Initial State**
```
10 â‡„ 20
 â–²    â”‚
 â””â”€â”€â”€â”€â”˜
```

### **Step 1: Create new_node (25)**
```
10 â‡„ 20

[25]  (not connected)
```

### **Step 2: new_node.next = temp.next (Line 13)**
```
10 â‡„ 20
     â–²
     â”‚
[25]â”€â”˜
```

### **Step 3: new_node.prev = temp (Line 14)**
```
10 â‡„ 20
 â”‚   â–²
 â””â†’[25]
```

### **Step 4: temp.next.prev = new_node (Line 17)**
```
10 â†’ 20
 â”‚   â–²
 â””â†’[25]
     â†“
```

### **Step 5: temp.next = new_node (Line 18)**
```
10 â‡„ 25 â‡„ 20
 â–²         â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

COMPLETE! âœ“
```

---

## Four Critical Pointer Updates

```
Order is IMPORTANT!

1. new_node.next = temp.next     (Line 13)
   Connect new node forward first
   (Safe - doesn't break existing links yet)

2. new_node.prev = temp          (Line 14)
   Connect new node backward
   (Still safe - new node isolated)

3. temp.next.prev = new_node     (Line 17)
   Update next node to point back to new node
   (Now we start modifying existing links)

4. temp.next = new_node          (Line 18)
   Update previous node to point to new node
   (Completes the insertion)
```

**Why this order?**
```
If we did (4) before (1):
â€¢ temp.next = new_node (update forward)
â€¢ Now temp.next points to new_node
â€¢ Then: new_node.next = temp.next
â€¢ This would make new_node.next = new_node (WRONG!)

Correct order prevents losing the reference to the next node!
```

---

## Complete Flow Chart

```
                    START
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Is empty?   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                â”‚
             YES              NO
              â”‚                â”‚
              â–¼                â–¼
        Print "empty"    temp = head
        Return                 â”‚
              â”‚                â–¼
              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚         â”‚ while True  â”‚
              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                â”‚
              â”‚                â–¼
              â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚         â”‚ temp.data   â”‚
              â”‚         â”‚ == value?   â”‚
              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                â”‚
              â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚        â”‚                â”‚
              â”‚       YES              NO
              â”‚        â”‚                â”‚
              â”‚        â–¼                â–¼
              â”‚   Create new      temp = temp.next
              â”‚   Set 4 pointers        â”‚
              â”‚   Print                 â–¼
              â”‚   Return         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚        â”‚         â”‚ temp ==     â”‚
              â”‚        â”‚         â”‚ head?       â”‚
              â”‚        â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚        â”‚                â”‚
              â”‚        â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”
              â”‚        â”‚        â”‚            â”‚
              â”‚        â”‚       YES          NO
              â”‚        â”‚        â”‚            â”‚
              â”‚        â”‚        â–¼            â”‚
              â”‚        â”‚   Print "not   â†â”€â”€â”€â”˜
              â”‚        â”‚   found"       (loop back)
              â”‚        â”‚        â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
                     END
```

---

## Time Complexity Analysis

| Case | Time | Reason |
|------|------|--------|
| **Best Case** | O(1) | Value found at first node |
| **Average Case** | O(n) | Value in middle, search n/2 nodes |
| **Worst Case** | O(n) | Value at end or not found |

**Space Complexity:** O(1) - Only one new node created

---

## Common Edge Cases

### **1. Insert after last node**
```
Before: 5 â‡„ 10 â‡„ 20 â‡„ (back to 5)
Insert 30 after 20

After: 5 â‡„ 10 â‡„ 20 â‡„ 30 â‡„ (back to 5)
```

### **2. Insert after first node**
```
Before: 5 â‡„ 10 â‡„ 20 â‡„ (back to 5)
Insert 7 after 5

After: 5 â‡„ 7 â‡„ 10 â‡„ 20 â‡„ (back to 5)
```

### **3. Single node list**
```
Before: 10 â‡„ (back to 10)
Insert 20 after 10

After: 10 â‡„ 20 â‡„ (back to 10)
```

---

## Key Patterns in Code

### **1. Circular Traversal**
```python
while True:
    # Process node
    temp = temp.next
    if temp == self.head:
        break
```

### **2. Four Pointer Updates**
```python
new_node.next = temp.next     # Forward from new
new_node.prev = temp          # Backward from new
temp.next.prev = new_node     # Backward to new
temp.next = new_node          # Forward to new
```

### **3. Search Pattern**
```python
while True:
    if temp.data == value:
        # Found - do action
        return
    temp = temp.next
    if temp == self.head:
        break
# Not found
```

---

## ğŸ‰ Complete Understanding!

**You now understand:**
- âœ… Empty list checking
- âœ… Circular traversal with `while True`
- âœ… Finding the target node
- âœ… **Four critical pointer updates (order matters!)**
- âœ… Maintaining doubly circular structure
- âœ… Handling "not found" case
- âœ… Why order of pointer updates is crucial

**Key Insight:**
```
The four pointer updates must happen in this order:
1. new_node.next = temp.next  (save reference)
2. new_node.prev = temp       (prepare new node)
3. temp.next.prev = new_node  (update surrounding)
4. temp.next = new_node       (complete insertion)

Wrong order = lost references = broken list! ğŸ’¥
```

**Perfect insertion in the middle of a doubly circular list! ğŸ”„â‡„**


# Complete Line-by-Line Explanation: Display, Search, and Count (Doubly Circular Linked List)

I'll explain all four methods with detailed diagrams.

---

# PART 1: DISPLAY FORWARD

## Complete Code with Line Numbers

```python
def display_forward(self):                  # Line 1
    if self.head is None:                   # Line 2
        print("Doubly Circular Linked List is empty")  # Line 3
        return                              # Line 4
                                            # Line 5 (blank)
    temp = self.head                        # Line 6
    print("Doubly Circular Linked List (Forward):")  # Line 7
                                            # Line 8 (blank)
    while True:                             # Line 9
        print(temp.data, end=" â‡„ ")         # Line 10
        temp = temp.next                    # Line 11
        if temp == self.head:               # Line 12
            break                           # Line 13
                                            # Line 14 (blank)
    print("(back to head)")                 # Line 15
```

---

## Example: Display List 5 â‡„ 10 â‡„ 25 â‡„ 20

### Initial State

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²              â”‚
         â”‚           â”‚              â–¼
         â”‚           â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚                  â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚                       â–²              â”‚
         â”‚                       â”‚              â–¼
         â”‚                       â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚                       â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                              â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                                   â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                           â””â”€â”€â†’

List: 5 â‡„ 10 â‡„ 25 â‡„ 20 â‡„ (back to 5)
Goal: Display all nodes in forward direction
```

---

## LINE 2-4: Check if Empty

```python
if self.head is None:
    print("Doubly Circular Linked List is empty")
    return
```

**In Our Case:**
```
self.head = 0x2B3C4D (points to Node 5)

Evaluation: FALSE â†’ Skip lines 3-4
```

---

## LINE 6: Initialize Traversal Pointer

```python
temp = self.head
```

**Diagram:**
```
    self.head
    temp          (both point to Node 5)
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Starting traversal from head
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 6                â”‚
â”‚                              â”‚
â”‚  temp â†’ 0x2B3C4D (Node 5)    â”‚
â”‚  self.head â†’ 0x2B3C4D        â”‚
â”‚                              â”‚
â”‚  Ready to traverse forward   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 7: Print Header

```python
print("Doubly Circular Linked List (Forward):")
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                               â”‚
â”‚                                         â”‚
â”‚  Doubly Circular Linked List (Forward): â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINES 9-13: Traversal Loop

```python
while True:                             # Line 9
    print(temp.data, end=" â‡„ ")         # Line 10
    temp = temp.next                    # Line 11
    if temp == self.head:               # Line 12
        break                           # Line 13
```

---

### **Iteration 1: temp at Node 5**

**LINE 10:** Print current node's data
```
         temp
          â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

print(temp.data, end=" â‡„ ")
â†’ print(5, end=" â‡„ ")

Console: "5 â‡„ "
```

**LINE 11:** Move to next node
```
temp = temp.next

temp moves from Node 5 to Node 10
```

**LINE 12:** Check if back at head
```
temp = Node 10
self.head = Node 5

temp == self.head?
Node 10 == Node 5? â†’ FALSE

Continue loop
```

**Visual Progress:**
```
    self.head                      temp
        â”‚                           â–¼
        â–¼                      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”     ...  â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’     â”‚ â†  â”‚    â”‚ â†’  â”‚
    â”‚ â†  â”‚    â”‚ â†’  â”‚          â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Console so far: "5 â‡„ "
```

---

### **Iteration 2: temp at Node 10**

**LINE 10:** Print
```
         temp
          â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Console: "10 â‡„ "
```

**LINE 11:** Move forward
```
temp = temp.next  (Node 25)
```

**LINE 12:** Check
```
temp == self.head?
Node 25 == Node 5? â†’ FALSE
```

**Console so far:** `"5 â‡„ 10 â‡„ "`

---

### **Iteration 3: temp at Node 25**

**LINE 10:** Print
```
Console: "25 â‡„ "
```

**LINE 11:** Move forward
```
temp = temp.next  (Node 20)
```

**LINE 12:** Check
```
temp == self.head?
Node 20 == Node 5? â†’ FALSE
```

**Console so far:** `"5 â‡„ 10 â‡„ 25 â‡„ "`

---

### **Iteration 4: temp at Node 20**

**LINE 10:** Print
```
         temp
          â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Console: "20 â‡„ "
```

**LINE 11:** Move forward
```
temp = temp.next

temp moves to Node 5 (back to head!)
```

**LINE 12:** Check if back at head
```
    self.head
    temp          (both at Node 5)
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

temp == self.head?
Node 5 == Node 5? â†’ TRUE âœ“

Execute LINE 13: break
```

**Console so far:** `"5 â‡„ 10 â‡„ 25 â‡„ 20 â‡„ "`

**Loop exits!**

---

## LINE 15: Print Completion

```python
print("(back to head)")
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                                    â”‚
â”‚                                              â”‚
â”‚  Doubly Circular Linked List (Forward):     â”‚
â”‚  5 â‡„ 10 â‡„ 25 â‡„ 20 â‡„ (back to head)          â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Traversal Animation

```
START
  â”‚
  â–¼
temp â†’ [5] â‡„ 10 â‡„ 25 â‡„ 20 â‡„
       Print "5 â‡„ "
       
Move
  â”‚
  â–¼
temp â†’ 5 â‡„ [10] â‡„ 25 â‡„ 20 â‡„
            Print "10 â‡„ "
            
Move
  â”‚
  â–¼
temp â†’ 5 â‡„ 10 â‡„ [25] â‡„ 20 â‡„
                 Print "25 â‡„ "
                 
Move
  â”‚
  â–¼
temp â†’ 5 â‡„ 10 â‡„ 25 â‡„ [20] â‡„
                      Print "20 â‡„ "
                      
Move
  â”‚
  â–¼
temp â†’ [5] â‡„ 10 â‡„ 25 â‡„ 20 â‡„ (back at head!)
       STOP!
       
Print "(back to head)"

DONE âœ“
```

---

---

# PART 2: DISPLAY BACKWARD

## Complete Code with Line Numbers

```python
def display_backward(self):                 # Line 1
    if self.head is None:                   # Line 2
        print("Doubly Circular Linked List is empty")  # Line 3
        return                              # Line 4
                                            # Line 5 (blank)
    # Start from last node                  # Line 6 (comment)
    last = self.head.prev                   # Line 7
    temp = last                             # Line 8
                                            # Line 9 (blank)
    print("Doubly Circular Linked List (Backward):")  # Line 10
                                            # Line 11 (blank)
    while True:                             # Line 12
        print(temp.data, end=" â‡„ ")         # Line 13
        temp = temp.prev                    # Line 14
        if temp == last:                    # Line 15
            break                           # Line 16
                                            # Line 17 (blank)
    print("(back to last)")                 # Line 18
```

---

## Example: Display Backward 5 â‡„ 10 â‡„ 25 â‡„ 20

### Initial State (Same List)

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²              â”‚
         â”‚           â”‚              â–¼
         â”‚           â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚                  â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚                       â–²              â”‚
         â”‚                       â”‚              â–¼
         â”‚                       â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚                       â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                              â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                                   â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                           â””â”€â”€â†’

Goal: Display all nodes in BACKWARD direction
Starting from: Last node (20)
Expected: 20 â‡„ 25 â‡„ 10 â‡„ 5 â‡„ (back to last)
```

---

## LINE 7: Find Last Node (O(1)!)

```python
last = self.head.prev
```

**What it does:**
- Directly accesses the last node via `self.head.prev`
- **O(1) operation** - instant access!

**Visual:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
      â–²
      â”‚
      â””â”€â”€ self.head.prev (points to last node)
      
       self.head.prev
            â”‚
            â–¼
       â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
       â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’ back to head
       â”‚ â†  â”‚    â”‚ â†’  â”‚
       â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
       
last = Node 20 (LAST NODE!)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 7                â”‚
â”‚                              â”‚
â”‚  last â†’ 0x4D5E6F (Node 20)   â”‚
â”‚  self.head â†’ 0x2B3C4D (5)    â”‚
â”‚                              â”‚
â”‚  Found last node in O(1)!    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 8: Initialize Temp

```python
temp = last
```

**What it does:**
- Sets `temp` to start from the last node
- Will traverse BACKWARD using `prev` pointers

**Diagram:**
```
    last
    temp          (both at Node 20)
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Starting traversal from LAST node
Will use PREV pointers to go backward
```

---

## LINE 10: Print Header

```python
print("Doubly Circular Linked List (Backward):")
```

**Console:**
```
Doubly Circular Linked List (Backward):
```

---

## LINES 12-16: Backward Traversal Loop

```python
while True:                             # Line 12
    print(temp.data, end=" â‡„ ")         # Line 13
    temp = temp.prev                    # Line 14 (KEY: using PREV!)
    if temp == last:                    # Line 15
        break                           # Line 16
```

**Key Difference:**
```
Forward:  temp = temp.next  (follow next pointers)
Backward: temp = temp.prev  (follow prev pointers)
```

---

### **Iteration 1: temp at Node 20 (Last)**

**LINE 13:** Print
```
    last
    temp
      â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Console: "20 â‡„ "
```

**LINE 14:** Move BACKWARD (using prev!)
```
temp = temp.prev

temp moves from Node 20 to Node 25
```

**LINE 15:** Check if back at starting point
```
temp = Node 25
last = Node 20

temp == last?
Node 25 == Node 20? â†’ FALSE

Continue loop
```

**Visual Progress:**
```
    last                              temp
      â–¼                                â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€ ... â†â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’
    â”‚ â†  â”‚    â”‚ â†’  â”‚          â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Console: "20 â‡„ "
Moving backward using prev pointer
```

---

### **Iteration 2: temp at Node 25**

**LINE 13:** Print
```
Console: "25 â‡„ "
```

**LINE 14:** Move backward
```
temp = temp.prev  (Node 10)
```

**LINE 15:** Check
```
temp == last?
Node 10 == Node 20? â†’ FALSE
```

**Console so far:** `"20 â‡„ 25 â‡„ "`

---

### **Iteration 3: temp at Node 10**

**LINE 13:** Print
```
Console: "10 â‡„ "
```

**LINE 14:** Move backward
```
temp = temp.prev  (Node 5)
```

**LINE 15:** Check
```
temp == last?
Node 5 == Node 20? â†’ FALSE
```

**Console so far:** `"20 â‡„ 25 â‡„ 10 â‡„ "`

---

### **Iteration 4: temp at Node 5 (Head)**

**LINE 13:** Print
```
         temp
          â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Console: "5 â‡„ "
```

**LINE 14:** Move backward
```
temp = temp.prev

temp moves from Node 5 to Node 20 (back to last!)
```

**LINE 15:** Check if back at starting point
```
    last
    temp          (both at Node 20)
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

temp == last?
Node 20 == Node 20? â†’ TRUE âœ“

Execute LINE 16: break
```

**Console so far:** `"20 â‡„ 25 â‡„ 10 â‡„ 5 â‡„ "`

**Loop exits!**

---

## LINE 18: Print Completion

```python
print("(back to last)")
```

**Final Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                                    â”‚
â”‚                                              â”‚
â”‚  Doubly Circular Linked List (Backward):    â”‚
â”‚  20 â‡„ 25 â‡„ 10 â‡„ 5 â‡„ (back to last)          â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Backward Traversal Animation

```
START (at LAST node 20)
  â”‚
  â–¼
temp â†’ [20] â† 25 â† 10 â† 5 â†
       Print "20 â‡„ "
       
Move BACKWARD
  â”‚
  â–¼
temp â†’ 20 â† [25] â† 10 â† 5 â†
             Print "25 â‡„ "
             
Move BACKWARD
  â”‚
  â–¼
temp â†’ 20 â† 25 â† [10] â† 5 â†
                  Print "10 â‡„ "
                  
Move BACKWARD
  â”‚
  â–¼
temp â†’ 20 â† 25 â† 10 â† [5] â†
                       Print "5 â‡„ "
                       
Move BACKWARD
  â”‚
  â–¼
temp â†’ [20] â† 25 â† 10 â† 5 â† (back at last!)
       STOP!
       
Print "(back to last)"

DONE âœ“
```

---

## Comparison: Forward vs Backward

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FORWARD TRAVERSAL                         â”‚
â”‚                                            â”‚
â”‚  Start: head (first node)                  â”‚
â”‚  Direction: next pointers â†’                â”‚
â”‚  Stop: when back at head                   â”‚
â”‚  Output: 5 â‡„ 10 â‡„ 25 â‡„ 20 â‡„ (back to head) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKWARD TRAVERSAL                        â”‚
â”‚                                            â”‚
â”‚  Start: last (head.prev)                   â”‚
â”‚  Direction: prev pointers â†                â”‚
â”‚  Stop: when back at last                   â”‚
â”‚  Output: 20 â‡„ 25 â‡„ 10 â‡„ 5 â‡„ (back to last) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

---

# PART 3: SEARCH METHOD

## Complete Code with Line Numbers

```python
def search(self, key):                      # Line 1
    if self.head is None:                   # Line 2
        print("List is empty")              # Line 3
        return                              # Line 4
                                            # Line 5 (blank)
    temp = self.head                        # Line 6
    position = 1                            # Line 7
                                            # Line 8 (blank)
    while True:                             # Line 9
        if temp.data == key:                # Line 10
            print(key, "found at position", position)  # Line 11
            return                          # Line 12
                                            # Line 13 (blank)
        temp = temp.next                    # Line 14
        position += 1                       # Line 15
                                            # Line 16 (blank)
        if temp == self.head:               # Line 17
            break                           # Line 18
                                            # Line 19 (blank)
    print(key, "not found in the list")     # Line 20
```

---

## Example: Search for 25

### Initial State

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
    Position: 1

         â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    ...â†’ â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
         â”‚ â†  â”‚    â”‚ â†’  â”‚
         â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
         Position: 2

              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         ...â†’ â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ... â† Looking for this!
              â”‚ â†  â”‚    â”‚ â†’  â”‚
              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
              Position: 3

                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              ...â†’ â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’
                   â”‚ â†  â”‚    â”‚ â†’  â”‚
                   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                   Position: 4

Goal: Find key = 25
Expected: "25 found at position 3"
```

---

## LINE 2-4: Check Empty

Skip (list has nodes)

---

## LINE 6-7: Initialize

```python
temp = self.head                        # Line 6
position = 1                            # Line 7
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINES 6-7             â”‚
â”‚                              â”‚
â”‚  temp â†’ Node 5 (head)        â”‚
â”‚  position â†’ 1                â”‚
â”‚  key â†’ 25 (searching for)    â”‚
â”‚                              â”‚
â”‚  Ready to search             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINES 9-18: Search Loop

---

### **Iteration 1: temp at Node 5, position = 1**

**LINE 10:** Check if found
```
         temp
          â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

if temp.data == key:
â†’ if 5 == 25:
â†’ FALSE âœ—

Skip lines 11-12
```

**LINE 14:** Move to next
```
temp = temp.next  (Node 10)
```

**LINE 15:** Increment position
```
position += 1  (position = 2)
```

**LINE 17:** Check if completed circle
```
temp == self.head?
Node 10 == Node 5? â†’ FALSE

Continue loop
```

**Progress:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ITERATION 1                 â”‚
â”‚                              â”‚
â”‚  Checked: Node 5             â”‚
â”‚  Result: Not found           â”‚
â”‚  Position: 1                 â”‚
â”‚                              â”‚
â”‚  Moving to: Node 10          â”‚
â”‚  New position: 2             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Iteration 2: temp at Node 10, position = 2**

**LINE 10:** Check
```
if 10 == 25: â†’ FALSE âœ—
```

**LINE 14-15:** Move and increment
```
temp = Node 25
position = 3
```

**LINE 17:** Circle check
```
Node 25 == Node 5? â†’ FALSE
```

---

### **Iteration 3: temp at Node 25, position = 3**

**LINE 10:** Check if found
```
         temp
          â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
    
    position = 3

if temp.data == key:
â†’ if 25 == 25:
â†’ TRUE âœ“ (FOUND!)

Execute lines 11-12
```

**LINE 11:** Print result
```python
print(key, "found at position", position)
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                       â”‚
â”‚                                 â”‚
â”‚  25 found at position 3         â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**LINE 12:** Exit function
```python
return
```

**Function exits** - Lines 14-20 NOT executed

---

## Search Not Found Example

What if we search for **100** (doesn't exist)?

**Process:**
- Position 1: Check 5 == 100? NO â†’ Move
- Position 2: Check 10 == 100? NO â†’ Move
- Position 3: Check 25 == 100? NO â†’ Move
- Position 4: Check 20 == 100? NO â†’ Move
- temp moves to Node 5 (back at head!)
- **LINE 17:** `temp == self.head?` â†’ **YES**
- **LINE 18:** `break` (exit loop)
- **LINE 20:** Print "100 not found in the list"

---

---

# PART 4: COUNT NODES METHOD

## Complete Code with Line Numbers

```python
def count_nodes(self):                      # Line 1
    if self.head is None:                   # Line 2
        print("Total number of nodes: 0")   # Line 3
        return 0                            # Line 4
                                            # Line 5 (blank)
    count = 0                               # Line 6
    temp = self.head                        # Line 7
                                            # Line 8 (blank)
    while True:                             # Line 9
        count += 1                          # Line 10
        temp = temp.next                    # Line 11
        if temp == self.head:               # Line 12
            break                           # Line 13
                                            # Line 14 (blank)
    print("Total number of nodes:", count)  # Line 15
    return count                            # Line 16
```

---

## Example: Count Nodes in 5 â‡„ 10 â‡„ 25 â‡„ 20

---

## LINE 2-4: Check Empty

Skip (list has nodes)

---

## LINE 6-7: Initialize

```python
count = 0                               # Line 6
temp = self.head                        # Line 7
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINES 6-7             â”‚
â”‚                              â”‚
â”‚  count â†’ 0                   â”‚
â”‚  temp â†’ Node 5 (head)        â”‚
â”‚                              â”‚
â”‚  Ready to count              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINES 9-13: Counting Loop

```python
while True:                             # Line 9
    count += 1                          # Line 10
    temp = temp.next                    # Line 11
    if temp == self.head:               # Line 12
        break                           # Line 13
```

---

### **Iteration 1: temp at Node 5**

**LINE 10:** Increment count
```
count += 1  (count = 1)

Counted Node 5
```

**LINE 11:** Move to next
```
temp = temp.next  (Node 10)
```

**LINE 12:** Check if back at head
```
temp == self.head?
Node 10 == Node 5? â†’ FALSE

Continue loop
```

**Progress:**
```
         temp
          â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚      â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜      â”‚ â†  â”‚    â”‚ â†’  â”‚
    âœ“ Counted (1)         â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                          Next to count
```

---

### **Iteration 2: temp at Node 10**

**LINE 10:** Increment
```
count += 1  (count = 2)
```

**LINE 11:** Move
```
temp = Node 25
```

**LINE 12:** Check
```
Node 25 == Node 5? â†’ FALSE
```

---

### **Iteration 3: temp at Node 25**

**LINE 10:** Increment
```
count += 1  (count = 3)
```

**LINE 11:** Move
```
temp = Node 20
```

**LINE 12:** Check
```
Node 20 == Node 5? â†’ FALSE
```

---

### **Iteration 4: temp at Node 20**

**LINE 10:** Increment
```
count += 1  (count = 4)

All nodes counted!
```

**LINE 11:** Move
```
temp = temp.next  (Node 5 - back to head!)
```

**LINE 12:** Check if back at head
```
    temp
    self.head     (both at Node 5)
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

temp == self.head?
Node 5 == Node 5? â†’ TRUE âœ“

Execute LINE 13: break
```

**Loop exits!**

---

## LINE 15-16: Print and Return

```python
print("Total number of nodes:", count)  # Line 15
return count                            # Line 16
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                       â”‚
â”‚                                 â”‚
â”‚  Total number of nodes: 4       â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Function returns: 4
```

---

## Counting Animation

```
START (count = 0)
  â”‚
  â–¼
[5] â‡„ 10 â‡„ 25 â‡„ 20 â‡„
count = 1

Move
  â”‚
  â–¼
5 â‡„ [10] â‡„ 25 â‡„ 20 â‡„
count = 2

Move
  â”‚
  â–¼
5 â‡„ 10 â‡„ [25] â‡„ 20 â‡„
count = 3

Move
  â”‚
  â–¼
5 â‡„ 10 â‡„ 25 â‡„ [20] â‡„
count = 4

Move
  â”‚
  â–¼
[5] â‡„ 10 â‡„ 25 â‡„ 20 â‡„ (back at head!)
STOP!

Total: 4 nodes âœ“
```

---

## Summary: All Four Methods

### **1. display_forward()**
```
â€¢ Start: head
â€¢ Direction: next â†’
â€¢ Stop: when back at head
â€¢ Output: 5 â‡„ 10 â‡„ 25 â‡„ 20 â‡„ (back to head)
â€¢ Time: O(n)
```

### **2. display_backward()**
```
â€¢ Start: last (head.prev) - O(1) access!
â€¢ Direction: prev â†
â€¢ Stop: when back at last
â€¢ Output: 20 â‡„ 25 â‡„ 10 â‡„ 5 â‡„ (back to last)
â€¢ Time: O(n)
```

### **3. search()**
```
â€¢ Tracks position (1-indexed)
â€¢ Returns when found
â€¢ Prints "not found" if complete circle
â€¢ Time: O(n)
```

### **4. count_nodes()**
```
â€¢ Increments counter for each node
â€¢ Stops when back at head
â€¢ Returns count
â€¢ Time: O(n)
```

---

## Common Pattern: Circular Traversal

All four methods use the same pattern:

```python
temp = starting_node
while True:
    # Process current node
    
    temp = temp.next  # or temp.prev for backward
    
    if temp == starting_node:
        break  # Completed full circle

# Post-loop processing
```

---

## Time Complexity Summary

| Method | Time | Space | Why |
|--------|------|-------|-----|
| **display_forward** | O(n) | O(1) | Visit each node once |
| **display_backward** | O(n) | O(1) | Visit each node once |
| **search** | O(n) | O(1) | May need to check all |
| **count_nodes** | O(n) | O(1) | Must visit all nodes |

---

## ğŸ‰ Complete Understanding!

**You now understand:**
- âœ… Circular traversal pattern with `while True`
- âœ… Forward traversal using `next` pointers
- âœ… **Backward traversal using `prev` pointers**
- âœ… **O(1) access to last node via `head.prev`**
- âœ… Stopping condition: back at starting point
- âœ… Position tracking in search
- âœ… Counter increment in count_nodes

**Key Advantages of Doubly Circular:**
```
1. Can traverse in BOTH directions
2. O(1) access to BOTH first and last nodes
3. No NULL pointers to check
4. Perfect for applications needing bidirectional navigation
```

**All display, search, and count operations fully explained! ğŸ”„â‡„**


# Complete Line-by-Line Explanation: Delete Operations (Doubly Circular Linked List)

I'll explain all three delete methods with detailed diagrams.

---

# PART 1: DELETE FROM BEGINNING

## Complete Code with Line Numbers

```python
def delete_beginning(self):                 # Line 1
    if self.head is None:                   # Line 2
        print("List is empty")              # Line 3
        return                              # Line 4
                                            # Line 5 (blank)
    # Only one node                         # Line 6 (comment)
    if self.head.next == self.head:         # Line 7
        print(self.head.data, "deleted (only node)")  # Line 8
        self.head = None                    # Line 9
        return                              # Line 10
                                            # Line 11 (blank)
    # More than one node                    # Line 12 (comment)
    last = self.head.prev                   # Line 13
    deleted_value = self.head.data          # Line 14
                                            # Line 15 (blank)
    # Update connections                    # Line 16 (comment)
    self.head.next.prev = last              # Line 17
    last.next = self.head.next              # Line 18
                                            # Line 19 (blank)
    # Move head                             # Line 20 (comment)
    self.head = self.head.next              # Line 21
                                            # Line 22 (blank)
    print(deleted_value, "deleted from beginning")  # Line 23
```

---

## Example Scenario

Delete first node from: **5 â‡„ 10 â‡„ 25 â‡„ 20 â‡„ (back to 5)**

### Initial State

```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²              â”‚
         â”‚           â”‚              â–¼
         â”‚           â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚                  â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚                       â–²              â”‚
         â”‚                       â”‚              â–¼
         â”‚                       â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚                       â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                              â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                                   â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                           â””â”€â”€â†’

Current List: 5 â‡„ 10 â‡„ 25 â‡„ 20 â‡„ (back to 5)
Goal: Delete Node 5 (head)
Expected: 10 â‡„ 25 â‡„ 20 â‡„ (back to 10)
```

---

## LINE 2-4: Check if Empty

```python
if self.head is None:
    print("List is empty")
    return
```

**In Our Case:** `self.head` points to Node 5 â†’ **FALSE** â†’ Skip

---

## LINE 7: Check if Only One Node

```python
if self.head.next == self.head:
```

**What it does:**
- Checks if there's only one node in the list
- Single node points to itself in circular structure

**Truth Table:**

| Condition | Meaning | Action |
|-----------|---------|--------|
| `head.next == head` | Single node (points to itself) | Lines 8-10 |
| `head.next != head` | Multiple nodes | Line 13+ |

**In Our Case:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ [Node 10] (NOT itself)
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

self.head.next = Node 10
self.head = Node 5

self.head.next == self.head?
Node 10 == Node 5? â†’ FALSE âœ—

Skip lines 8-10, continue to line 13
```

---

## LINES 8-10: Single Node Case (SKIPPED)

**What it would do if executed:**
```python
print(self.head.data, "deleted (only node)")  # Line 8
self.head = None                              # Line 9
return                                        # Line 10
```

**Example (if list had only one node):**

**Before:**
```
    self.head
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**After:**
```
self.head = None

Output: "5 deleted (only node)"
List is now empty
```

**In our case: SKIPPED** (we have multiple nodes)

---

## LINE 13: Find Last Node (O(1)!)

```python
last = self.head.prev
```

**What it does:**
- Directly accesses the last node via `self.head.prev`
- **O(1) operation** - no traversal needed!

**Visual:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
      â–²
      â”‚
      â””â”€â”€ self.head.prev points to last node
      
                              last
                               â–¼
                          â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
                          â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’ back to head
                          â”‚ â†  â”‚    â”‚ â†’  â”‚
                          â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 13               â”‚
â”‚                              â”‚
â”‚  self.head â†’ Node 5          â”‚
â”‚  last â†’ Node 20              â”‚
â”‚                              â”‚
â”‚  Found last node in O(1)!    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 14: Save Value Being Deleted

```python
deleted_value = self.head.data
```

**What it does:**
- Saves the data from the node being deleted
- Used for printing confirmation message later

**State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 14               â”‚
â”‚                              â”‚
â”‚  deleted_value â†’ 5           â”‚
â”‚  self.head â†’ Node 5          â”‚
â”‚  last â†’ Node 20              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Current Situation Before Deletion

```
       self.head (to be deleted)
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â” â† Will become new head
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚           â–²              â”‚
         â”‚           â”‚              â–¼
         â”‚           â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚           â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚                  â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚                       â–²              â”‚
         â”‚                       â”‚              â–¼
         â”‚                       â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚                       â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â” â† last
         â”‚                              â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                              â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                                   â–²             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                           â””â”€â”€â†’

Connections to update:
â€¢ Last (20) â†’ Head (5): Should point to new head (10)
â€¢ New head (10) â† Last (20): Should point back to last (20)
```

---

## LINE 17: Update Second Node's Prev to Last

```python
self.head.next.prev = last
```

**What it does:**
- Makes the **second node** (Node 10) point backward to the **last node** (Node 20)
- Fixes the backward circular link

**Breaking it down:**
```
self.head.next.prev = last

self.head â†’ Node 5 (current head)
self.head.next â†’ Node 10 (second node, will be new head)
self.head.next.prev â†’ Node 10's prev pointer

We're setting: Node 10's prev = last (Node 20)
```

**Visual Explanation:**

**BEFORE Line 17:**
```
                   self.head.next
                        â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
              â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚
              â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
              â”‚
         Points to Node 5 (OLD)
```

**Executing Line 17:**
```
self.head.next.prev = last

Step 1: Identify target
    self.head.next â†’ Node 10
    self.head.next.prev â†’ Node 10's prev pointer

Step 2: Evaluate right side
    last â†’ Node 20

Step 3: Assign
    Node 10's prev â† Node 20

Result: Node 10 now points backward to Node 20
```

**AFTER Line 17:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â–²  â”‚           â”‚
         â”‚  â”‚           â–¼
         â”‚  â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚  â””â”€â”€â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚       â–²  â”‚               â”‚
         â”‚       â”‚  â”‚               â–¼
         â”‚       â”‚  â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚       â”‚  â””â”€â”€â”€â”€â”€â†’â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
         â”‚       â”‚         â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
         â”‚       â”‚         â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
         â”‚       â”‚              â–²              â”‚
         â”‚       â”‚              â”‚              â–¼
         â”‚       â”‚              â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
         â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
         â”‚                      â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
         â”‚                      â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
         â”‚                      â”‚  last      â–²            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚            â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         
         self.head.next.prev = last
         (Node 10 now points back to Node 20)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 17               â”‚
â”‚                              â”‚
â”‚  NODE 10:                    â”‚
â”‚  â€¢ prev â†’ Node 20 (NEW!)     â”‚
â”‚  â€¢ data â†’ 10                 â”‚
â”‚  â€¢ next â†’ Node 25            â”‚
â”‚                              â”‚
â”‚  âœ… Backward link updated    â”‚
â”‚  âŒ Forward link from last   â”‚
â”‚     still needs update       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 18: Update Last's Next to Second Node

```python
last.next = self.head.next
```

**What it does:**
- Makes the **last node** (Node 20) point forward to the **second node** (Node 10)
- Fixes the forward circular link

**Visual Explanation:**

**BEFORE Line 18:**
```
                               last
                                â–¼
                           â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
                           â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
                           â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                           â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                                â”‚             â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           Still points to Node 5 (OLD)
```

**Executing Line 18:**
```
last.next = self.head.next

Step 1: Evaluate right side
    self.head.next â†’ Node 10

Step 2: Assign to left side
    last.next â† Node 10

Result: Node 20 now points forward to Node 10
```

**AFTER Line 18:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
    (Will be              â”‚
    unreachable)          â”‚
                          â–¼
                  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
             â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
             â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
             â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
             â”‚         â–²              â”‚
             â”‚         â”‚              â–¼
             â”‚         â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
             â”‚         â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
             â”‚                â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
             â”‚                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
             â”‚                     â–²              â”‚
             â”‚                     â”‚              â–¼
             â”‚                     â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
                                   â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                                   â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                                   â”‚  last      â–²            â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                                                             â””â”€â”€â†’
         
         last.next = self.head.next
         (Node 20 now points forward to Node 10)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 18               â”‚
â”‚                              â”‚
â”‚  Circular links updated:     â”‚
â”‚  â€¢ Node 10 â† Node 20 âœ“       â”‚
â”‚  â€¢ Node 10 â†’ Node 20 âœ“       â”‚
â”‚                              â”‚
â”‚  Node 5 bypassed but still   â”‚
â”‚  pointed to by HEAD          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 21: Update HEAD to Second Node

```python
self.head = self.head.next
```

**What it does:**
- Moves HEAD to point to the second node (Node 10)
- Makes Node 10 the new first node
- Node 5 becomes unreachable

**Visual Explanation:**

**BEFORE Line 21:**
```
       self.head (still at Node 5)
           â”‚
           â–¼
       [Node 5]
```

**Executing Line 21:**
```
self.head = self.head.next

Step 1: Evaluate right side
    self.head.next â†’ Node 10

Step 2: Assign to left side
    self.head â† Node 10

Result: HEAD now points to Node 10
```

**AFTER Line 21:**
```
                   self.head (moved here!)
                        â”‚
                        â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 5  â”‚ â—â”€â”€â”¼â†’â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
    â”‚ â†  â”‚    â”‚ â†’  â”‚ â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
    (Unreachable)         â–²              â”‚
    Will be garbage       â”‚              â–¼
    collected             â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
                          â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
                                 â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
                                 â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
                                      â–²              â”‚
                                      â”‚              â–¼
                                      â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
                                      â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
                                             â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                                             â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                                                  â–²             â”‚
                                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

self.head = self.head.next
(HEAD moved to Node 10)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 21               â”‚
â”‚                              â”‚
â”‚  âœ… DELETION COMPLETE!       â”‚
â”‚  âœ… HEAD â†’ Node 10           â”‚
â”‚  âœ… Node 10 â‡„ 25 â‡„ 20 â‡„ 10   â”‚
â”‚  âœ… Node 5 unreachable       â”‚
â”‚     (will be garbage         â”‚
â”‚      collected)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 23: Print Confirmation

```python
print(deleted_value, "deleted from beginning")
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                           â”‚
â”‚                                     â”‚
â”‚  5 deleted from beginning           â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Final State

```
                   self.head
                        â”‚
                        â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚         â–²              â”‚
              â”‚         â”‚              â–¼
              â”‚         â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚         â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚                â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚                     â–²              â”‚
              â”‚                     â”‚              â–¼
              â”‚                     â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
                                    â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                                    â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                                    â”‚           â–²             â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                              â””â”€â”€â†’

New List: 10 â‡„ 25 â‡„ 20 â‡„ (back to 10)
Node 5 has been deleted!
```

**Verification:**
```
âœ… Total nodes: 3 (was 4)
âœ… HEAD points to: Node 10 (was Node 5)
âœ… Last node (20) points to: Node 10 (head)
âœ… First node (10) points back to: Node 20 (last)
âœ… Doubly circular structure: Maintained
âœ… Node 5: Unreachable (garbage collected)
```

---

---

# PART 2: DELETE FROM END

## Complete Code with Line Numbers

```python
def delete_end(self):                       # Line 1
    if self.head is None:                   # Line 2
        print("List is empty")              # Line 3
        return                              # Line 4
                                            # Line 5 (blank)
    # Only one node                         # Line 6 (comment)
    if self.head.next == self.head:         # Line 7
        print(self.head.data, "deleted (only node)")  # Line 8
        self.head = None                    # Line 9
        return                              # Line 10
                                            # Line 11 (blank)
    # More than one node                    # Line 12 (comment)
    last = self.head.prev                   # Line 13
    deleted_value = last.data               # Line 14
                                            # Line 15 (blank)
    # Update connections                    # Line 16 (comment)
    last.prev.next = self.head              # Line 17
    self.head.prev = last.prev              # Line 18
                                            # Line 19 (blank)
    print(deleted_value, "deleted from end")  # Line 20
```

---

## Example Scenario

Delete last node from: **10 â‡„ 25 â‡„ 20 â‡„ (back to 10)**

### Initial State

```
                   self.head
                        â”‚
                        â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚         â–²              â”‚
              â”‚         â”‚              â–¼
              â”‚         â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚         â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚                â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚                     â–²              â”‚
              â”‚                     â”‚              â–¼
              â”‚                     â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
                                    â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                                    â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                                    â”‚           â–²  last       â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                              â””â”€â”€â†’

Current List: 10 â‡„ 25 â‡„ 20 â‡„ (back to 10)
Goal: Delete Node 20 (last node)
Expected: 10 â‡„ 25 â‡„ (back to 10)
```

---

## LINES 2-10: Check Empty & Single Node

Same as delete_beginning

**In Our Case:** Multiple nodes â†’ Skip to line 13

---

## LINE 13: Find Last Node (O(1)!)

```python
last = self.head.prev
```

**Visual:**
```
       self.head.prev
            â”‚
            â–¼
       â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
       â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’ back to head
       â”‚ â†  â”‚    â”‚ â†’  â”‚
       â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
       
last = Node 20 (the last node to delete)
```

---

## LINE 14: Save Value Being Deleted

```python
deleted_value = last.data
```

**State:**
```
deleted_value = 20
last = Node 20
```

---

## Current Situation Before Deletion

```
                   self.head
                        â”‚
                        â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚         â–²              â”‚
              â”‚         â”‚              â–¼
              â”‚         â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â” â† Will become new last
              â”‚         â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚                â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚                     â–²              â”‚
              â”‚                     â”‚              â–¼
              â”‚                     â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â” â† To delete
                                    â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                                    â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                                    â”‚           â–²  last       â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                              â””â”€â”€â†’

Connections to update:
â€¢ Second-to-last (25) â†’ Last (20): Should point to head (10)
â€¢ Head (10) â† Second-to-last (25): Should point back to (25)
```

---

## LINE 17: Update Second-to-Last's Next to Head

```python
last.prev.next = self.head
```

**What it does:**
- Makes the **second-to-last node** (Node 25) point forward to **head** (Node 10)
- Bypasses the last node (Node 20)

**Breaking it down:**
```
last.prev.next = self.head

last â†’ Node 20 (last node)
last.prev â†’ Node 25 (second-to-last)
last.prev.next â†’ Node 25's next pointer

We're setting: Node 25's next = head (Node 10)
```

**Visual Explanation:**

**BEFORE Line 17:**
```
                              last.prev
                                â–¼
                           â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
                           â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ [Node 20]
                           â”‚ â†  â”‚    â”‚ â†’  â”‚
                           â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                                â”‚
                           Points to Node 20
```

**AFTER Line 17:**
```
                   self.head
                        â”‚
                        â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚         â–²              â”‚
              â”‚         â”‚              â–¼
              â”‚         â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚         â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”
              â”‚                â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
              â”‚                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
              â”‚                     â–²             â”‚
              â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                                   â”‚       â”‚
              â”‚                           â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”â”‚
              â”‚                           â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”˜
              â”‚                           â”‚ â†  â”‚    â”‚ â†’  â”‚
              â”‚                           â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
              â”‚                        (Unreachable soon)
              â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
              
         last.prev.next = self.head
         (Node 25 now points to Node 10)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 17               â”‚
â”‚                              â”‚
â”‚  NODE 25:                    â”‚
â”‚  â€¢ prev â†’ Node 10            â”‚
â”‚  â€¢ data â†’ 25                 â”‚
â”‚  â€¢ next â†’ Node 10 (NEW!)     â”‚
â”‚                              â”‚
â”‚  âœ… Forward link updated     â”‚
â”‚  âŒ Backward link from head  â”‚
â”‚     still needs update       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 18: Update Head's Prev to Second-to-Last

```python
self.head.prev = last.prev
```

**What it does:**
- Makes **head** (Node 10) point backward to the **second-to-last node** (Node 25)
- Completes the circular structure

**Visual Explanation:**

**BEFORE Line 18:**
```
       self.head
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
      â–²
      â”‚
      â””â”€â”€ Still points to Node 20 (last - to be deleted)
```

**AFTER Line 18:**
```
                   self.head
                        â”‚
                        â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚         â–²              â”‚
              â”‚         â”‚              â–¼
              â”‚         â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚         â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”
              â”‚                â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
              â”‚                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
              â”‚                     â–²             â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                  â””â”€â”€â”€â”€â”€â”€â”€â”
                                                          â”‚
                                                  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
                                                  â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
                                                  â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                                                  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                                               (Unreachable)        â”‚
                                               Will be garbage      â”‚
                                               collected            â”‚
                                                                   â””â”€â”€â†’
         
         self.head.prev = last.prev
         (Head now points back to Node 25)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINE 18               â”‚
â”‚                              â”‚
â”‚  âœ… DELETION COMPLETE!       â”‚
â”‚  âœ… HEAD â†’ Node 10           â”‚
â”‚  âœ… Node 10 â‡„ 25 â‡„ (10)      â”‚
â”‚  âœ… Node 20 unreachable      â”‚
â”‚     (will be garbage         â”‚
â”‚      collected)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINE 20: Print Confirmation

```python
print(deleted_value, "deleted from end")
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                           â”‚
â”‚                                     â”‚
â”‚  20 deleted from end                â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Final State

```
                   self.head
                        â”‚
                        â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚         â–²              â”‚
              â”‚         â”‚              â–¼
              â”‚         â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚         â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”
              â”‚                â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
              â”‚                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
              â”‚                     â–²             â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                  â””â”€â”€â†’

New List: 10 â‡„ 25 â‡„ (back to 10)
Node 20 has been deleted!
```

---

---

# PART 3: DELETE A GIVEN ELEMENT

## Complete Code with Line Numbers

```python
def delete_element(self, key):              # Line 1
    if self.head is None:                   # Line 2
        print("List is empty")              # Line 3
        return                              # Line 4
                                            # Line 5 (blank)
    temp = self.head                        # Line 6
                                            # Line 7 (blank)
    while True:                             # Line 8
        if temp.data == key:                # Line 9
            # Only one node                 # Line 10 (comment)
            if temp.next == temp:           # Line 11
                self.head = None            # Line 12
                print(key, "deleted (only node)")  # Line 13
                return                      # Line 14
                                            # Line 15 (blank)
            # Deleting head                 # Line 16 (comment)
            if temp == self.head:           # Line 17
                self.delete_beginning()     # Line 18
                return                      # Line 19
                                            # Line 20 (blank)
            # Deleting non-head node        # Line 21 (comment)
            temp.prev.next = temp.next      # Line 22
            temp.next.prev = temp.prev      # Line 23
                                            # Line 24 (blank)
            print(key, "deleted from the list")  # Line 25
            return                          # Line 26
                                            # Line 27 (blank)
        temp = temp.next                    # Line 28
                                            # Line 29 (blank)
        if temp == self.head:               # Line 30
            break                           # Line 31
                                            # Line 32 (blank)
    print(key, "not found")                 # Line 33
```

---

## Example Scenario

Delete node with value **25** from: **10 â‡„ 25 â‡„ 20 â‡„ (back to 10)**

### Initial State

```
                   self.head
                        â”‚
                        â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚         â–²              â”‚
              â”‚         â”‚              â–¼
              â”‚         â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â” â† To delete
              â”‚         â””â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚                â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚                     â–²              â”‚
              â”‚                     â”‚              â–¼
              â”‚                     â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
                                    â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                                    â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                                    â”‚           â–²             â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                              â””â”€â”€â†’

Goal: Delete Node 25 (middle node)
Expected: 10 â‡„ 20 â‡„ (back to 10)
```

---

## LINES 2-4: Check Empty

Skip (list has nodes)

---

## LINE 6: Initialize Traversal

```python
temp = self.head
```

```
temp = Node 10 (head)
```

---

## LINES 8-31: Search Loop

---

### **Iteration 1: temp at Node 10**

**LINE 9:** Check if matches
```
temp.data = 10
key = 25

10 == 25? â†’ FALSE âœ—

Skip deletion logic (lines 11-26)
```

**LINE 28:** Move to next
```
temp = temp.next  (Node 25)
```

**LINE 30:** Check circle
```
temp == self.head?
Node 25 == Node 10? â†’ FALSE
```

---

### **Iteration 2: temp at Node 25**

**LINE 9:** Check if matches
```
         temp
          â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â†’ ...
    â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

temp.data = 25
key = 25

25 == 25? â†’ TRUE âœ“ (FOUND!)

Execute deletion logic
```

---

## LINE 11: Check if Only One Node

```python
if temp.next == temp:
```

**In Our Case:**
```
temp.next = Node 20 (NOT itself)

FALSE â†’ Skip lines 12-14
```

---

## LINE 17: Check if Deleting Head

```python
if temp == self.head:
```

**In Our Case:**
```
temp = Node 25
self.head = Node 10

Node 25 == Node 10? â†’ FALSE

Skip lines 18-19
Continue to line 22 (non-head deletion)
```

---

## LINES 22-23: Delete Non-Head Node

```python
temp.prev.next = temp.next      # Line 22
temp.next.prev = temp.prev      # Line 23
```

**What it does:**
- Bypasses the node being deleted (Node 25)
- Updates both forward and backward links

---

### **LINE 22: Update Previous Node's Next**

```python
temp.prev.next = temp.next
```

**Breaking it down:**
```
temp â†’ Node 25 (to delete)
temp.prev â†’ Node 10
temp.prev.next â†’ Node 10's next pointer
temp.next â†’ Node 20

We're setting: Node 10's next = Node 20
```

**Visual:**

**BEFORE Line 22:**
```
         temp.prev          temp          temp.next
              â–¼              â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â†’â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â†’â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’
    â”‚ â†  â”‚    â”‚ â†’  â”‚   â”‚ â†  â”‚    â”‚ â†’  â”‚   â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
```

**AFTER Line 22:**
```
         temp.prev          temp          temp.next
              â–¼              â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
    â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â†’â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â†’
    â”‚ â†  â”‚    â”‚ â†’  â”‚   â”‚ â†  â”‚ 25 â”‚ â†’  â”‚   â”‚ â†  â”‚    â”‚ â†’  â”‚
    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                       (Bypassed forward)

temp.prev.next = temp.next
(Node 10 now points to Node 20)
```

---

### **LINE 23: Update Next Node's Prev**

```python
temp.next.prev = temp.prev
```

**Breaking it down:**
```
temp.next â†’ Node 20
temp.next.prev â†’ Node 20's prev pointer
temp.prev â†’ Node 10

We're setting: Node 20's prev = Node 10
```

**AFTER Line 23:**
```
                   self.head
                        â”‚
                        â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚         â–²              â”‚
              â”‚         â”‚              â”‚
              â”‚         â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”‚         â”‚      â”‚ â—â†â”€â”¼ 25 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚         â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚         â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚         â”‚   (Unreachable)          â”‚
              â”‚         â”‚                           â”‚
              â”‚         â”‚                           â–¼
              â”‚         â”‚                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
                        â”‚                   â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                        â”‚                   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                        â”‚                        â–²             â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                               â””â”€â”€â†’

temp.next.prev = temp.prev
(Node 20 now points back to Node 10)
```

**Memory State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER LINES 22-23           â”‚
â”‚                              â”‚
â”‚  âœ… DELETION COMPLETE!       â”‚
â”‚  âœ… Node 10 â†’ Node 20        â”‚
â”‚  âœ… Node 20 â† Node 10        â”‚
â”‚  âœ… Node 25 unreachable      â”‚
â”‚  âœ… Circular structure OK    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LINES 25-26: Print and Exit

```python
print(key, "deleted from the list")  # Line 25
return                               # Line 26
```

**Console Output:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Console:                           â”‚
â”‚                                     â”‚
â”‚  25 deleted from the list           â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Final State

```
                   self.head
                        â”‚
                        â–¼
                   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”‚ â—â†â”€â”¼ 10 â”‚ â—â”€â”€â”¼â”€â”€â”€â”€â”
              â”‚    â”‚ â†  â”‚    â”‚ â†’  â”‚    â”‚
              â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜    â”‚
              â”‚         â–²              â”‚
              â”‚         â”‚              â–¼
              â”‚         â”‚      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ â—â†â”€â”¼ 20 â”‚ â—â”€â”€â”¼â”€â”€â”
                        â”‚      â”‚ â†  â”‚    â”‚ â†’  â”‚  â”‚
                        â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜  â”‚
                        â”‚           â–²             â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                  â””â”€â”€â†’

New List: 10 â‡„ 20 â‡„ (back to 10)
Node 25 has been deleted!
```

---

## Summary: All Three Delete Methods

### **1. delete_beginning()**
```
â€¢ Check: Empty â†’ Single â†’ Multiple
â€¢ O(1) access to last via head.prev
â€¢ Update: second.prev, last.next, head
â€¢ Time: O(1)
```

### **2. delete_end()**
```
â€¢ Check: Empty â†’ Single â†’ Multiple
â€¢ O(1) access to last via head.prev
â€¢ Update: second-to-last.next, head.prev
â€¢ Time: O(1)
```

### **3. delete_element(key)**
```
â€¢ Search for node with key
â€¢ Three cases:
  - Only one node â†’ head = None
  - Head node â†’ call delete_beginning()
  - Non-head â†’ bypass node (2 updates)
â€¢ Time: O(n) for search
```

---

## Two Pointer Updates Pattern (Non-Head Deletion)

```python
# When deleting node 'temp' from middle:

temp.prev.next = temp.next  # Forward bypass
temp.next.prev = temp.prev  # Backward bypass

Result: Node completely bypassed in both directions
```

---

## Comparison: Delete Operations

| Operation | Access Last | Updates | Time |
|-----------|-------------|---------|------|
| **delete_beginning** | O(1) | 3 pointers | O(1) |
| **delete_end** | O(1) | 2 pointers | O(1) |
| **delete_element** | N/A | 2-3 pointers | O(n) |

**Key Advantage:**
```
Doubly Circular allows O(1) deletion from BOTH ends!
â€¢ head.prev gives instant last node access
â€¢ No traversal needed for end deletion
```

---

## ğŸ‰ Complete Understanding!

**You now understand:**
- âœ… Empty and single node checks
- âœ… **O(1) last node access via `head.prev`**
- âœ… **O(1) delete from beginning**
- âœ… **O(1) delete from end**
- âœ… O(n) delete by value (search required)
- âœ… Two-pointer bypass for non-head deletion
- âœ… Maintaining doubly circular structure
- âœ… Three cases in delete_element

**Key Insight:**
```
Doubly circular excels at deletions:
â€¢ Both ends: O(1) - fastest possible!
â€¢ By value: O(n) - only search time
â€¢ Always maintain bidirectional circular links
```

**All deletion operations fully mastered! ğŸ”„â‡„âœ¨**